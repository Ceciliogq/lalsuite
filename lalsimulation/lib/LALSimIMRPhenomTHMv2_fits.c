/*
 * Copyright (C) 2020 Hector Estelles
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with with program; see the file COPYING. If not, write to the
 *  Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
 *  MA  02110-1301  USA
 */


/**
 * \author Hector Estelles
 */

#include <lal/XLALError.h>
#include <math.h>

/**** Set of phenomenological fits employed by IMRPhenomT and IMRPhenomTHM models. Collocation points and coefficients have been calibrated with 531 BBH non-precessing NR simulations from the
last release of the SXS Catalog, additional BAM NR simulations at q=4, q=8 and q=18, and numerical Teukolsky waveforms placed at q=200 and q=1000. Calibration procedure has followed the
hierarchical data-driven fitting approach (Xisco Jimenez-Forteza et al https://arxiv.org/abs/1611.00332) using the symmetric mass ratio eta, dimensionless effective spin Shat=(m1^2*chi1+m2^2*chi2)/(m1^2+m2^2)
and spin difference dchi=chi1-chi2. Supplementary material for the fits is available at https://git.ligo.org/waveforms/reviews/phenomt/-/tree/master/SupplementaryMaterial/Fits3DPhenomTHM ****/

/******************************* Orbital phase fits ********************/

static double IMRPhenomTv2_Inspiral_CP1(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Inspiral_CP2(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Inspiral_CP3(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Inspiral_CP4(double eta, double S, double dchi, double delta);

static double IMRPhenomTv2_Intermediate_CP1(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Intermediate_CP2(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Intermediate_CP3(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Intermediate_CP4(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Intermediate_CP5(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Intermediate_CP6(double eta, double S, double dchi, double delta);

static double IMRPhenomTv2_Merger_CP7(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Merger_CP8(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Merger_CP9(double eta, double S, double dchi, double delta);

static double IMRPhenomTv2_xPeak(double eta, double S, double dchi, double delta);

/** Inspiral 22 frequency collocation points **/

static double IMRPhenomTv2_Inspiral_CP1(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 0.9683880424646004 + 0.10828598825077926*eta + dchi*delta*(-0.04893158248203795 - 0.34212604738191865*eta)*eta + S*(0.11740485443033946 - 0.11320526709622647*eta + 0.05212627464143796*pow(eta,2)) + 2.686646038892371*pow(eta,2) + (-0.042837566966377943 + 0.17708004689926632*eta)*pow(dchi,2)*pow(eta,2) + dchi*(0.060553990433657036 + 1.841677076065949*eta)*S*pow(delta,2)*pow(eta,2) - 73.82182725659172*pow(eta,3) + 1073.6475067701679*pow(eta,4) - 8746.740134360552*pow(eta,5) + 40093.03458366279*pow(eta,6) - 96533.77883411612*pow(eta,7) + 94937.71952661747*pow(eta,8) + (-0.012066924193685725 + 0.05666658932594215*eta - 0.18701949190260378*pow(eta,2))*pow(S,2) + (-0.017327878884297324 + 0.20605055934877145*eta - 0.5650373040663069*pow(eta,2))*pow(S,3) + (0.022469055614171646 - 0.35790245200575266*eta + 1.0853333375240515*pow(eta,2))*pow(S,4) + (0.019304375735338553 - 0.23673069484016177*eta + 0.655838229260232*pow(eta,2))*pow(S,5) +
   (-0.024686939463619814 + 0.382354276331063*eta - 1.1511952117362383*pow(eta,2))*pow(S,6);
    return fit;
}

static double IMRPhenomTv2_Inspiral_CP2(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 0.8562991593641929 + 0.2700913876948451*eta + dchi*delta*(-0.0599805372303908 - 0.6836328786800338*eta)*eta + S*(0.18182986285295286 + 0.15750667565294252*eta - 0.6680777899311787*pow(eta,2)) + 0.007881700670706438*pow(eta,2) + (0.021627283203002622 - 0.08407820799173144*eta)*pow(dchi,2)*pow(eta,2) + dchi*(-0.07745334831913049 - 4.457835277714547*eta)*S*pow(delta,2)*pow(eta,2) + 0.3314421719678552*pow(eta,3) + (0.052603556922093196 + 0.01769587795887811*eta - 0.3331097971731475*pow(eta,2))*pow(S,2) + (0.27583479695850704 - 2.769329526406066*eta + 7.066912744156553*pow(eta,2))*pow(S,3) + (0.022326824261464172 - 0.4280846093800745*eta + 2.1860307342763234*pow(eta,2))*pow(S,4) + (-0.7309889317304281 + 7.692639018022733*eta - 19.206424351669966*pow(eta,2))*pow(S,5) + (-0.21592118368290444 + 2.484738749254295*eta - 7.570869821982082*pow(eta,2))*pow(S,6) + (0.6029801363367482 - 6.122304122173575*eta + 15.184380632108093*pow(eta,2))*pow(S,7) + (0.28097675148089973 - 2.763597159543387*eta + 7.282063233628676*pow(eta,2))*pow(S,8);
    return fit;
}

static double IMRPhenomTv2_Inspiral_CP3(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 0.6689110602659 + 0.3975979969692713*eta + dchi*delta*(-0.00001954065558969806 - 1.2223537323763227*eta)*eta + S*(0.24571899202776165 + 0.26229802442747896*eta - 0.5666220612185938*pow(eta,2)) + 0.8058601341434538*pow(eta,2) + (0.09384362492017433 - 0.39386543095671944*eta)*pow(dchi,2)*pow(eta,2) + dchi*(0.6303561382082384 - 18.590130668528747*eta)*S*pow(delta,2)*pow(eta,2) - 0.5490712491450306*pow(eta,3) + (0.022874498614772466 + 1.1996298267540548*eta - 3.026520196943475*pow(eta,2))*pow(S,2) + (0.2726265568041184 - 1.4819165574769992*eta + 2.3261513784575367*pow(eta,2))*pow(S,3) + (1.6313519118588444 - 17.618848488939246*eta + 43.98619671914927*pow(eta,2))*pow(S,4) + (0.7729823873528151 - 12.788359518476328*eta + 41.02127805873492*pow(eta,2))*pow(S,5) + (-6.571414133891445 + 73.72748788491094*eta - 184.88390400672824*pow(eta,2))*pow(S,6) + (-3.7583260671486762 + 48.191153733900535*eta - 135.45755817245956*pow(eta,2))*pow(S,7) + (9.690896800908815 - 112.0792310698316*eta + 286.34160192010506*pow(eta,2))*pow(S,8) + (3.422276801585852 - 40.43865889116253*eta + 109.06162168146427*pow(eta,2))*pow(S,9) + (-4.536328275348794 + 55.2401012094734*eta - 144.4738476371749*pow(eta,2))*pow(S,10);
    return fit;
}

static double IMRPhenomTv2_Inspiral_CP4(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 0.3932643924229476 + 0.13494962975994562*eta + S*(0.18355114410584197 + 1.4446533815456397*eta - 2.17834240614184*pow(eta,2)) + 56.510842754657986*pow(eta,2) + (0.04558325338207419 - 0.1716287841108677*eta)*pow(dchi,2)*pow(eta,2) - 1745.3481710087806*pow(eta,3) - 7.890929809624612*dchi*delta*pow(eta,3) + 32330.271517034522*pow(eta,4) - 366005.5615158404*pow(eta,5) - 693.6705869387524*dchi*S*pow(delta,2)*pow(eta,5) + 2.5743443566328594e6*pow(eta,6) - 1.118178409413257e7*pow(eta,7) + 2.875980142924923e7*pow(eta,8) - 3.9241066276045576e7*pow(eta,9) + 2.0957568327072777e7*pow(eta,10) + (-0.147292234581865 + 3.914959372080455*eta - 8.788081950227337*pow(eta,2))*pow(S,2) + (1.6555819370597864 - 15.041633097831042*eta + 34.621869052945236*pow(eta,2))*pow(S,3) + (5.5689081806229055 - 59.04213489231151*eta + 145.75148106527442*pow(eta,2))*pow(S,4) + (-4.193213825559648 + 36.66500375681905*eta - 69.51291949039499*pow(eta,2))*pow(S,5) + (-23.21268229368484 + 252.53126551725782*eta - 625.7229987440189*pow(eta,2))*pow(S,6) + (1.5814572384588064 - 2.2990952056791945*eta - 30.734377621865846*pow(eta,2))*pow(S,7) + (34.16834151187815 - 378.6465036702285*eta + 949.9071438758634*pow(eta,2))*pow(S,8) + (2.6726891544970215 - 34.63984244821301*eta + 105.4863697173639*pow(eta,2))*pow(S,9) + (-15.599217748951412 + 179.17280689433207*eta - 456.5400228819059*pow(eta,2))*pow(S,10);
    return fit;
}

/** Intermediate 22 frequency collocation points **/

static double IMRPhenomTv2_Intermediate_CP1(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 5*pow(eta,-1)*(-1.4111702626041025 - 58.42369690908161*eta + 1602.895623375169*pow(eta,2) - 44.22132647595651*dchi*delta*pow(eta,2) + (-2.74396501116055 + 11.716635285476755*eta)*pow(dchi,2)*pow(eta,2) - 39882.188453109295*pow(eta,3) + S*(0.08720667403478197 + 26.473377669229826*eta - 52.14057158907762*pow(eta,2) + 74.47545347157514*pow(eta,3)) + 641556.8644327961*pow(eta,4) + 819.726226368901*dchi*S*pow(delta,2)*pow(eta,4) - 6.716608109179729e6*pow(eta,5) + 4.630834056966141e7*pow(eta,6) - 2.0864707615575957e8*pow(eta,7) + 5.912354583415904e8*pow(eta,8) - 9.563434046986115e8*pow(eta,9) + 6.7352055438724e8*pow(eta,10) + (-0.6301529164449722 + 3.4515767481455235*eta - 33.497036275843456*pow(eta,2) + 64.01279239111479*pow(eta,3))*pow(S,2) + (0.35800341124217266 - 19.169034644840092*eta + 155.24692868804956*pow(eta,2) - 325.6870695647675*pow(eta,3))*pow(S,3) + (0.1514365094162884 - 7.222707016905556*eta + 14.850784953959883*pow(eta,2) + 66.14820963149134*pow(eta,3))*pow(S,4) + (-2.4682010003976362 + 81.89395977255646*eta - 582.2409891006488*pow(eta,2) + 1182.6194300297443*pow(eta,3))*pow(S,5) + (1.1258108193409637 - 3.2307996158261982*eta + 50.58216696332851*pow(eta,2) - 260.52989414727585*pow(eta,3))*pow(S,6) + (2.9288069992480734 - 89.97078159671791*eta + 629.0056552535194*pow(eta,2) - 1261.9023086016061*pow(eta,3))*pow(S,7) + (-2.8745445449930616 + 27.14339161202973*eta - 124.05728666394192*pow(eta,2) + 275.47159348435315*pow(eta,3))*pow(S,8));
    return fit;
}

static double IMRPhenomTv2_Intermediate_CP2(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 5*pow(eta,-1)*(-0.5906714555349689 - 45.57276610223121*eta + 624.9536187484166*pow(eta,2) - 32.744091101133435*dchi*delta*pow(eta,2) + (-2.0022922812655017 + 8.598784729501052*eta)*pow(dchi,2)*pow(eta,2) - 2046.5810207483207*pow(eta,3) + S*(-0.30974490748018807 + 19.64695214930695*eta - 28.80387908541503*pow(eta,2) + 35.43565222665545*pow(eta,3)) - 139952.72858123033*pow(eta,4) + 421.08600316639706*dchi*S*pow(delta,2)*pow(eta,4) + 2.952568808019441e6*pow(eta,5) - 2.9150287722789407e7*pow(eta,6) + 1.6649737186397758e8*pow(eta,7) - 5.622479772243041e8*pow(eta,8) + 1.0439992047345079e9*pow(eta,9) - 8.228567101835812e8*pow(eta,10) + (-0.36315708186650636 + 7.716297174800148*eta - 71.19724844511593*pow(eta,2) + 157.1029414649568*pow(eta,3))*pow(S,2) + (0.23960209576629035 + 8.007745179732828*eta - 95.08237850966307*pow(eta,2) + 250.94793868552756*pow(eta,3))*pow(S,3) + (0.1332570487443247 - 18.252069570720526*eta + 128.47352230817154*pow(eta,2) - 225.35026463057247*pow(eta,3))*pow(S,4) + (-2.1725640093448275 - 8.54452072784731*eta + 244.20378733250467*pow(eta,2) - 709.2966849589649*pow(eta,3))*pow(S,5) + (-0.7460971777436742 + 6.7050115374118375*eta + 65.38012359420755*pow(eta,2) - 332.250585055687*pow(eta,3))*pow(S,6) + (2.6226964297255644 - 5.800895170847055*eta - 137.95303808615122*pow(eta,2) + 487.25374468838777*pow(eta,3))*pow(S,7) + (0.2812479100687652 + 15.744504491944676*eta - 219.0944747544586*pow(eta,2) + 620.3649606310777*pow(eta,3))*pow(S,8));
    return fit;
}

static double IMRPhenomTv2_Intermediate_CP3(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 5*pow(eta,-1)*(-0.043670899144957566 - 77.94163545371248*eta + 2826.6201506427715*pow(eta,2) - 25.085292552091374*dchi*delta*pow(eta,2) + (-1.3892180236595797 + 6.002820257926306*eta)*pow(dchi,2)*pow(eta,2) + S*(-0.27668280991260064 + 12.247333164887849*eta - 1.82771634337083*pow(eta,2) - 8.718721530182338*pow(eta,3)) - 66056.88330753168*pow(eta,3) + 940275.9597743688*pow(eta,4) + 187.85658128329402*dchi*S*pow(delta,2)*pow(eta,4) - 8.614336533558065e6*pow(eta,5) + 5.1991758013738886e7*pow(eta,6) - 2.0560121007539466e8*pow(eta,7) + 5.1234458626481086e8*pow(eta,8) - 7.29042265469394e8*pow(eta,9) + 4.509763914868371e8*pow(eta,10) + (-0.32827338379154686 + 9.035791107589894*eta - 74.2976059810675*pow(eta,2) + 159.6541904458206*pow(eta,3))*pow(S,2) + (-0.25635020799469943 + 26.980654090680407*eta - 248.77179699330148*pow(eta,2) + 592.7745647243099*pow(eta,3))*pow(S,3) + (0.6687653081757601 - 31.611571928128377*eta + 231.90040618927807*pow(eta,2) - 458.5844860536752*pow(eta,3))*pow(S,4) + (-0.09903476106488003 - 79.83866585695291*eta + 794.8291145600604*pow(eta,2) - 1905.994847968201*pow(eta,3))*pow(S,5) + (-3.554842682792393 + 62.43195498605119*eta - 314.9750826896286*pow(eta,2) + 478.55767785248366*pow(eta,3))*pow(S,6) + (0.08084804526820305 + 70.97214238875361*eta - 704.3413957086541*pow(eta,2) + 1688.3376196508432*pow(eta,3))*pow(S,7) + (3.944463670947548 - 49.320638189346184*eta + 183.04122105533776*pow(eta,2) - 183.65513390106045*pow(eta,3))*pow(S,8));
    return fit;
}


static double IMRPhenomTv2_Intermediate_CP4(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 5*pow(eta,-1)*(0.04931882933907463 - 54.107856760146156*eta + 1870.7706446527286*pow(eta,2) - 19.86990692394674*dchi*delta*pow(eta,2) + (-1.014945341358774 + 4.447194499675716*eta)*pow(dchi,2)*pow(eta,2) + S*(-0.13502856450320422 + 7.377303179145844*eta + 8.343075099022276*pow(eta,2) - 15.484517576837753*pow(eta,3)) - 42690.857781852326*pow(eta,3) + 575486.7607689361*pow(eta,4) + 50.38320176486205*dchi*S*pow(delta,2)*pow(eta,4) - 4.804036962609339e6*pow(eta,5) + 2.5154720422133856e7*pow(eta,6) - 8.0447539298317e7*pow(eta,7) + 1.4362111395113185e8*pow(eta,8) - 1.095576255862231e8*pow(eta,9) - 350715.2303004704*pow(eta,10) + (-0.2804699989871015 + 3.505092249903875*eta - 17.325375001026227*pow(eta,2) + 25.06952572826201*pow(eta,3))*pow(S,2) + (-0.625799699764115 + 25.461455797276628*eta - 204.61275830442037*pow(eta,2) + 460.67123151259693*pow(eta,3))*pow(S,3) + (0.5031652266041478 + 4.384275341220451*eta - 108.77975002671349*pow(eta,2) + 342.84836303972554*pow(eta,3))*pow(S,4) + (1.5902039056217638 - 88.53766621227335*eta + 747.8156435399549*pow(eta,2) - 1683.1084907201705*pow(eta,3))*pow(S,5) + (-2.299026953865872 - 23.46626096906038*eta + 437.040061628976*pow(eta,2) - 1242.223667601623*pow(eta,3))*pow(S,6) + (-1.9826575924295642 + 92.12551352849012*eta - 751.9053084120828*pow(eta,2) + 1670.2846169792344*pow(eta,3))*pow(S,7) + (2.2219506975272316 + 20.698597920767824*eta - 379.81439815283886*pow(eta,2) + 1060.6744238300157*pow(eta,3))*pow(S,8));
    return fit;
}


static double IMRPhenomTv2_Intermediate_CP5(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 5*pow(eta,-1)*(0.0552111287336302 - 36.821359771110764*eta + (-0.08263582422796424 + 0.41457356196711115*eta)*eta*pow(dchi,2) + 1198.3409141542697*pow(eta,2) - 35.59082419864473*dchi*delta*pow(eta,2.5) + S*(-0.03981379399158583 + 2.1309776573029704*eta + 33.94738855577555*pow(eta,2) - 65.17560006961229*pow(eta,3)) - 27170.656221364276*pow(eta,3) + 362815.117567684*pow(eta,4) - 2.9648711323640826e6*pow(eta,5) + 1.4784240073209386e7*pow(eta,6) - 4.208787414895303e7*pow(eta,7) - 4698.832967508499*dchi*S*pow(delta,2)*pow(eta,7) + 5.287993299738955e7*pow(eta,8) + 1.668159989699019e7*pow(eta,9) - 8.005574450133505e7*pow(eta,10) + (-0.10627264767205398 + 0.8108380041075087*eta - 10.450402367012545*pow(eta,2) + 36.50515854355166*pow(eta,3))*pow(S,2) + (-0.45289702399453774 + 21.06715462666458*eta - 172.8410371692878*pow(eta,2) + 395.5687603462943*pow(eta,3))*pow(S,3) + (-0.1389263390244439 + 5.43737097087074*eta - 17.609937676001415*pow(eta,2) - 6.560049830623164*pow(eta,3))*pow(S,4) + (1.13601070951666 - 62.42896208377686*eta + 522.8178342865782*pow(eta,2) - 1177.2375724301287*pow(eta,3))*pow(S,5) + (-0.09772218236921457 - 26.15224901761195*eta + 211.44414589379238*pow(eta,2) - 423.50925904133265*pow(eta,3))*pow(S,6) + (-1.5991034283464147 + 63.46156353646098*eta - 495.8741486788085*pow(eta,2) + 1082.9247013073286*pow(eta,3))*pow(S,7) + (-0.18418662372866487 + 32.21526358512869*eta - 266.6520126585561*pow(eta,2) + 570.5942132395566*pow(eta,3))*pow(S,8));
    return fit;
}


static double IMRPhenomTv2_Intermediate_CP6(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 5*pow(eta,-1)*(0.024278007629264277 - 19.778996438447287*eta + (-0.08866533789190659 + 0.42569420142453684*eta)*eta*pow(dchi,2) + 402.77229017976356*pow(eta,2) - 29.813804189069625*dchi*delta*pow(eta,2.5) + S*(-0.0057091416716707095 + 0.7991037278780031*eta + 34.40512883565935*pow(eta,2) - 65.3559813701346*pow(eta,3)) - 5302.252510898191*pow(eta,3) + 878.6692323899998*pow(eta,4) + 843170.3088354127*pow(eta,5) - 1.1237203626450898e7*pow(eta,6) + 7.271293264403006e7*pow(eta,7) - 8607.043560068803*dchi*S*pow(delta,2)*pow(eta,7) - 2.6184872568431345e8*pow(eta,8) + 5.032458209172017e8*pow(eta,9) - 4.035383721698084e8*pow(eta,10) + (-0.061953570337150383 - 1.9276671386989805*eta + 18.26764270890624*pow(eta,2) - 35.10183547285278*pow(eta,3))*pow(S,2) + (-0.4495773393361017 + 22.57949083030847*eta - 192.97588767171283*pow(eta,2) + 451.49363668035966*pow(eta,3))*pow(S,3) + (-0.01618683280102668 + 16.715758214410283*eta - 146.4461849962498*pow(eta,2) + 323.8655117610664*pow(eta,3))*pow(S,4) + (1.5011125736188744 - 72.7957171137474*eta + 609.7857817438912*pow(eta,2) - 1382.1629899056331*pow(eta,3))*pow(S,5) + (-0.07141927678918146 - 52.74302839821393*eta + 478.1897538785338*pow(eta,2) - 1071.5723247893009*pow(eta,3))*pow(S,6) + (-2.013091306286387 + 73.8405590358286*eta - 575.3651882661942*pow(eta,2) + 1260.982297553029*pow(eta,3))*pow(S,7) + (-0.36103565926481784 + 51.71842321755787*eta - 445.4415932838789*pow(eta,2) + 987.3815327339687*pow(eta,3))*pow(S,8));
    return fit;
}

/** Merger 22 frequency collocation points **/

static double IMRPhenomTv2_Merger_CP7(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = -28.70132399256388 - 264.8869896794178*eta - 58.660471165399464*dchi*delta*pow(eta,1.5) + 21032.570108520526*pow(eta,2) + (-0.09785502763099825 + 3.6307819922308284*eta)*pow(dchi,2)*pow(eta,2) -  540639.4977210629*pow(eta,3) + S*(-7.283589875809176 + 167.4366080953371*eta - 549.075217374588*pow(eta,2) + 608.1396423240161*pow(eta,3)) + 7.540739057897123e6*pow(eta,4) - 6.360689236291559e7*pow(eta,5) - 22160.433207800572*dchi*S*pow(delta,2)*pow(eta,5) + 3.336733892263183e8*pow(eta,6) - 1.0655357009629552e9*pow(eta,7) + 1.8974812377503295e9*pow(eta,8) - 1.4453378926246974e9*pow(eta,9) + (-20.7281788845938 + 360.14691284764643*eta - 1800.2181013822174*pow(eta,2) + 2997.468000082948*pow(eta,3))*pow(S,2) + (-22.956366417511152 + 1252.8491929596726*eta - 10330.508662604465*pow(eta,2) + 22828.29667553328*pow(eta,3))*pow(S,3) + (45.58155633997533 - 671.2014027052552*eta + 2503.550536937337*pow(eta,2) - 2071.728201845664*pow(eta,3))*pow(S,4) + (54.37932917449492 - 4863.185832057347*eta + 42296.67247034543*pow(eta,2) - 94630.98005884652*pow(eta,3))*pow(S,5) + (-314.12139867803535 + 4653.6860316982475*eta - 20702.20334189201*pow(eta,2) + 28309.589684599072*pow(eta,3))*pow(S,6) + (-439.6097932793355 + 13844.03875532931*eta - 100430.20497738924*pow(eta,2) + 208006.52544461814*pow(eta,3))*pow(S,7) + (211.05159596189503 - 3096.8696144951955*eta + 13451.260000112885*pow(eta,2) - 17603.320638549532*pow(eta,3))*pow(S,8) + (378.10374914137617 - 10054.992193518296*eta + 68747.40717882274*pow(eta,2) - 138063.16452266913*pow(eta,3))*pow(S,9);
    return fit;
}

static double IMRPhenomTv2_Merger_CP8(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = -14.437832078002838 - 48.542404803483066*eta - 24.650443905577003*dchi*delta*pow(eta,1.5) + 4793.237236238058*pow(eta,2) + (3.808025224977121 - 14.12185769830352*eta)*pow(dchi,2)*pow(eta,2) - 127386.7620319267*pow(eta,3) + S*(-3.1452865175412597 + 59.66056301486045*eta - 148.45016752174678*pow(eta,2) + 80.74664446586317*pow(eta,3)) + 1.8368772175563928e6*pow(eta,4) - 1.6050348499238502e7*pow(eta,5) - 15274.863312846313*dchi*S*pow(delta,2)*pow(eta,5) + 8.722643607898346e7*pow(eta,6) - 2.882749399810531e8*pow(eta,7) + 5.3055684648243773e8*pow(eta,8) - 4.1708716661487854e8*pow(eta,9) + (-7.450391332137607 + 57.406994549790134*eta + 49.752082975058244*pow(eta,2) - 486.35642362670035*pow(eta,3))*pow(S,2) + (-8.470080000329522 + 362.21040990617377*eta - 2863.687453950226*pow(eta,2) + 6273.987439865065*pow(eta,3))*pow(S,3) + (3.8069727834634097 + 431.5996248958705*eta - 4478.8239093562*pow(eta,2) + 10817.114436019625*pow(eta,3))*pow(S,4) + (4.754239489036353 - 741.1261032744279*eta + 6407.050098960692*pow(eta,2) - 13912.633291562215*pow(eta,3))*pow(S,5) + (-63.629533176978285 - 313.5506661041839*eta + 7620.710268316936*pow(eta,2) - 21430.499222314826*pow(eta,3))*pow(S,6) + (-86.64627193683307 + 1854.220150889058*eta - 10643.780334090241*pow(eta,2) + 18194.507111151863*pow(eta,3))*pow(S,7) + (31.526804230940726 + 537.3818385852106*eta - 7426.764821633536*pow(eta,2) + 19172.083568873742*pow(eta,3))*pow(S,8) + (63.93546643737997 - 930.7234172748759*eta + 3713.134481712558*pow(eta,2) - 3868.098730561706*pow(eta,3))*pow(S,9);
    return fit;
}

static double IMRPhenomTv2_Merger_CP9(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = -5.411819399120241 - 149.9536801441853*eta - 8.938466232284224*dchi*delta*pow(eta,1.5) + 8711.468683463943*pow(eta,2) + (2.3579730581508094 - 9.246300186499306*eta)*pow(dchi,2)*pow(eta,2) + S*(-0.8287676905132931 + 15.410948800683823*eta - 19.98143253271744*pow(eta,2) - 29.504716570469938*pow(eta,3)) - 215840.86207035184*pow(eta,3) + 2.9649869647383764e6*pow(eta,4) - 2.4598317629999246e7*pow(eta,5) - 6774.04682830553*dchi*S*pow(delta,2)*pow(eta,5) + 1.263471928254525e8*pow(eta,6) - 3.934295720343423e8*pow(eta,7) + 6.810491934572792e8*pow(eta,8) - 5.031906721860944e8*pow(eta,9) + (-2.067593249528319 - 10.377501565226625*eta + 288.18864848613714*pow(eta,2) - 798.0566083579357*pow(eta,3))*pow(S,2) + (-3.964982522722309 + 86.65683330935161*eta - 568.6191013640454*pow(eta,2) + 1169.4337754876192*pow(eta,3))*pow(S,3) + (-2.667092245638214 + 338.86594611271187*eta - 3112.59860767553*pow(eta,2) + 7262.980002519698*pow(eta,3))*pow(S,4) + (1.6801640289631135 + 59.625639808283246*eta - 825.4084670908063*pow(eta,2) + 2331.3346220169724*pow(eta,3))*pow(S,5) + (-10.1545618129368 - 593.4943461771161*eta + 6420.867774228519*pow(eta,2) - 15610.311981747067*pow(eta,3))*pow(S,6) + (-16.21139993630863 - 258.24853202190627*eta + 4120.9591346676325*pow(eta,2) - 11440.619285680554*pow(eta,3))*pow(S,7) + (2.1488510218875074 + 542.9894717005533*eta - 5308.627834816251*pow(eta,2) + 12478.040985959693*pow(eta,3))*pow(S,8) + (4.377874022577692 + 439.12350656943084*eta - 4891.056129645771*pow(eta,2) + 12346.097527826014*pow(eta,3))*pow(S,9);
    return fit;
}

static double IMRPhenomTv2_xPeak(double eta, double S, double dchi, double delta)
{
 double fit;

    fit = 0.252243025432081 + 3.5384642554498846*eta - 0.0008100372181577419*dchi*delta*pow(eta,1.5) - 179.17912106748238*pow(eta,2) + (0.016644307318927257 - 0.08394789047954129*eta)*pow(dchi,2)*pow(eta,2) + 4409.183019202182*pow(eta,3) + S*(0.056277322043923064 + 0.12743938257441287*eta - 1.3427375730815476*pow(eta,2) + 2.587096736542788*pow(eta,3)) - 61367.108278807995*pow(eta,4) + 521666.9824448282*pow(eta,5) - 8.557618670690161*dchi*S*pow(delta,2)*pow(eta,5) - 2.7642271037972937e6*pow(eta,6) + 8.916063737739675e6*pow(eta,7) - 1.6025001525547413e7*pow(eta,8) + 1.2307872357207134e7*pow(eta,9) + (0.03404337753270651 - 0.7115565741043901*eta + 5.761463079777303*pow(eta,2) - 13.201041164351969*pow(eta,3))*pow(S,2) + (0.04822672406991336 - 3.159971145575669*eta + 26.06967270203602*pow(eta,2) - 57.02422985879526*pow(eta,3))*pow(S,3) + (0.026304929378622995 + 2.362743157459869*eta - 22.84606724706768*pow(eta,2) + 52.59135116013178*pow(eta,3))*pow(S,4) + (-0.04867998265120952 + 11.668790301266858*eta - 99.61040049431743*pow(eta,2) + 216.5328033085896*pow(eta,3))*pow(S,5) + (-0.13468874091821256 - 2.049223099826566*eta + 25.097720559517608*pow(eta,2) - 59.5823160204279*pow(eta,3))*pow(S,6) + (-0.178592083424872 - 13.710972563268015*eta + 126.52222571938928*pow(eta,2) - 277.5487826185579*pow(eta,3))*pow(S,7) + (0.2207177886402693 - 1.2623531779980777*eta + 0.316265871950034*pow(eta,2) + 5.0415885664500175*pow(eta,3))*pow(S,8) + (0.3994368364790252 + 2.025218920684429*eta - 35.79552952528084*pow(eta,2) + 86.33600881058983*pow(eta,3))*pow(S,9);
    return fit;
}
