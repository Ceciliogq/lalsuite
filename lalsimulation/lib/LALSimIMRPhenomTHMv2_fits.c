/*
 * Copyright (C) 2020 Hector Estelles
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with with program; see the file COPYING. If not, write to the
 *  Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
 *  MA  02110-1301  USA
 */


/**
 * \author Hector Estelles
 */

#include <lal/XLALError.h>
#include <math.h>

/**** Set of phenomenological fits employed by IMRPhenomT and IMRPhenomTHM models. Collocation points and coefficients have been calibrated with 531 BBH non-precessing NR simulations from the
last release of the SXS Catalog, additional BAM NR simulations at q=4, q=8 and q=18, and numerical Teukolsky waveforms placed at q=200 and q=1000. Calibration procedure has followed the
hierarchical data-driven fitting approach (Xisco Jimenez-Forteza et al https://arxiv.org/abs/1611.00332) using the symmetric mass ratio eta, dimensionless effective spin Shat=(m1^2*chi1+m2^2*chi2)/(m1^2+m2^2)
and spin difference dchi=chi1-chi2. Supplementary material for the fits is available at https://git.ligo.org/waveforms/reviews/phenomt/-/tree/master/SupplementaryMaterial/Fits3DPhenomTHM ****/

/******************************* Orbital phase fits ********************/

static double IMRPhenomTv2_Inspiral_CP1(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Inspiral_CP2(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Inspiral_CP3(double eta, double S, double dchi, double delta);

static double IMRPhenomTv2_LateInspiral_CP1(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_LateInspiral_CP2(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_LateInspiral_CP3(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_LateInspiral_CP4(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_LateInspiral_CP5(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_LateInspiral_CP6(double eta, double S, double dchi, double delta);

static double IMRPhenomTv2_Merger_CP1(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Merger_CP2(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_Merger_CP3(double eta, double S, double dchi, double delta);

static double IMRPhenomTv2_xCutMergerFit(double eta, double S, double dchi, double delta);
static double IMRPhenomTv2_xPeak(double eta, double S, double dchi, double delta);

static UNUSED double IMRPhenomT_Inspiral_Amp_CP0_22v2(double eta, double S, double dchi, double delta);
static double IMRPhenomT_Inspiral_Amp_CP1_22v2(double eta, double S, double dchi, double delta);
static double IMRPhenomT_Inspiral_Amp_CP2_22v2(double eta, double S, double dchi, double delta);
static double IMRPhenomT_Inspiral_Amp_CP3_22v2(double eta, double S, double dchi, double delta);
static double IMRPhenomT_Inspiral_Amp_CP4_22v2(double eta, double S, double dchi, double delta);
static double IMRPhenomT_Inspiral_Amp_CP5_22v2(double eta, double S, double dchi, double delta);

/** Inspiral 22 frequency collocation points **/

static double IMRPhenomTv2_Inspiral_CP1(double eta, double S, double dchi, double delta)
{
    double fit;

    fit = -0.00081599816710943 + 0.011350750230468894*eta + dchi*delta*(-0.00013576818794470798 + 0.014857509897304368*eta)*eta + dchi*(-0.0012860498834294798 + 0.025200618013722132*eta)*eta*S*pow(delta,0.5) + S*(-0.0022992894337506287 - 0.0027583585297817205*eta + 0.01407006892375988*pow(eta,2)) - 0.31092631175307933*pow(eta,2) + 4.267280526504877*pow(eta,3) - 29.326246183857005*pow(eta,4) + (-0.23358184869309692 + 0.9625152396468807*eta)*pow(dchi,2)*pow(eta,4) + 106.57743318948405*pow(eta,5) - 194.28342202379065*pow(eta,6) + 137.84896454234516*pow(eta,7) + (-0.0007945743915663082 + 0.010743765347812793*eta - 0.03483761506884408*pow(eta,2))*pow(S,2) + (0.00007733256032730024 + 0.006008040527028353*eta - 0.02372826288613223*pow(eta,2))*pow(S,3) + (0.007506243139182913 - 0.08969979631256264*eta + 0.23756366564506037*pow(eta,2))*pow(S,4) + (-0.0076872286992004475 + 0.09170246088490999*eta - 0.2358583761761203*pow(eta,2))*pow(S,5) + (-0.006049842006332803 + 0.07037957824417847*eta - 0.18512045659285864*pow(eta,2))*pow(S,6) + (0.007554176673814706 - 0.09188273734513612*eta + 0.2439197525176345*pow(eta,2))*pow(S,7);
    return fit;
}

static double IMRPhenomTv2_Inspiral_CP2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = -0.004598176260778315 + 0.029092278960813515*eta + dchi*delta*(0.00235364827457941 + 0.013799425913552016*eta)*eta + dchi*(-0.00035379285706909843 + 0.028120419729200864*eta)*eta*S*pow(delta,0.5) + 2.942034498122123*pow(eta,2) - 112.62316370806784*pow(eta,3) + S*(-0.01715341538057281 + 0.2163534283062929*eta - 1.382940622239022*pow(eta,2) + 3.855461576352188*pow(eta,3) - 3.737907602577937*pow(eta,4)) + 1931.0097402996796*pow(eta,4) + (-0.3472108290430057 + 1.444385665267222*eta)*pow(dchi,2)*pow(eta,4) - 18749.26910360631*pow(eta,5) + 109061.75360893692*pow(eta,6) - 376679.09560934454*pow(eta,7) + 712812.745180163*pow(eta,8) - 569583.0847679287*pow(eta,9) + (0.002906684921235369 - 0.03498639449505876*eta + 0.04623409648110013*pow(eta,2) + 0.8062002470604188*pow(eta,3) - 2.479334656695461*pow(eta,4))*pow(S,2) + (0.0053123525098955305 - 0.11467363037765561*eta + 0.26012856044992416*pow(eta,2) + 3.482641405886058*pow(eta,3) - 11.987733797402543*pow(eta,4))*pow(S,3) + (0.00125016104993579 - 0.028502530564847743*eta + 0.32152004688631847*pow(eta,2) - 1.908330211038555*pow(eta,3) + 3.871931365142184*pow(eta,4))*pow(S,4) + (-0.01022937898080261 + 0.22583641704965104*eta - 0.5660964437760477*pow(eta,2) - 4.8256821934107155*pow(eta,3) + 16.44475628828177*pow(eta,4))*pow(S,5) + (-0.000084846894681971 - 0.0017235542589612396*eta + 0.08517864924933038*pow(eta,2) - 0.7955518026292798*pow(eta,3) + 2.041005498921907*pow(eta,4))*pow(S,6) + (0.005771036971418824 - 0.12966919593701*eta + 0.27736844626880675*pow(eta,2) + 3.0493887419716326*pow(eta,3) - 9.828071879239703*pow(eta,4))*pow(S,7);
  return fit;
}

static double IMRPhenomTv2_Inspiral_CP3(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = -0.01652831446577041 + 0.3297605574313261*eta + dchi*delta*(0.005974889208031036 + 0.013920539345112618*eta)*eta + dchi*(-0.00017222148558306805 + 0.037003537571258356*eta)*eta*S*pow(delta,0.5) - 0.053146577763895406*pow(eta,2) - 118.47648480397112*pow(eta,3) + S*(-0.060837180869705035 + 1.0611369989870874*eta - 8.351142392785496*pow(eta,2) + 30.046564107760833*pow(eta,3) - 40.56417295213976*pow(eta,4)) + 2439.548845365885*pow(eta,4) + (-0.5014507769045545 + 2.0844108535112142*eta)*pow(dchi,2)*pow(eta,4) - 24948.27548114114*pow(eta,5) + 148076.76557222172*pow(eta,6) - 516113.9848033331*pow(eta,7) + 980867.3998659671*pow(eta,8) - 785184.5812842272*pow(eta,9) + (0.009714231087498564 - 0.13208369612901333*eta + 0.38380025910845833*pow(eta,2) + 1.5431570813335491*pow(eta,3) - 6.242674677702274*pow(eta,4))*pow(S,2) + (0.034086346004746124 - 1.2352496125171282*eta + 13.817688716137884*pow(eta,2) - 61.195124092926974*pow(eta,3) + 94.18313831597591*pow(eta,4))*pow(S,3) + (0.011004401985748874 - 0.4187684847309061*eta + 5.412605263303543*pow(eta,2) - 27.781499746661492*pow(eta,3) + 48.293150124078274*pow(eta,4))*pow(S,4) + (-0.07108034489020411 + 2.6243157803022745*eta - 29.872633732301423*pow(eta,2) + 136.7002090940622*pow(eta,3) - 218.70169689019355*pow(eta,4))*pow(S,5) + (-0.004079527767409107 + 0.22797143994024213*eta - 3.263324604856041*pow(eta,2) + 16.529247248124967*pow(eta,3) - 27.2466958532921*pow(eta,4))*pow(S,6) + (0.038890901690402574 - 1.4961758445590765*eta + 17.277000783850173*pow(eta,2) - 79.90072357828807*pow(eta,3) + 128.71615444509763*pow(eta,4))*pow(S,7);
  return fit;
}



/** Intermediate 22 frequency collocation points **/

static double IMRPhenomTv2_LateInspiral_CP1(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 5*pow(eta,-1)*(-18.6712201188575 - 531.7855320244457*eta - 8402.105909884798*pow(eta,2) + 25004.532428100894*pow(eta,3) - 293342.74954980187*pow(eta,4) - 586721.7310053812*pow(eta,5) + 5.456836636554547e7*pow(eta,6) - 4.428937086815475e8*pow(eta,7) + 1.5668339296969326e9*pow(eta,8) + S*(-21.824943853902205 - 559.3211836469897*eta + 9112.951634791378*pow(eta,2) - 205225.87863697275*pow(eta,3) + 2.385685136809003e6*pow(eta,4) - 1.5367167923258228e7*pow(eta,5) + 5.76178735254942e7*pow(eta,6) - 1.1818588368900219e8*pow(eta,7) + 1.0238595043042481e8*pow(eta,8)) - 2.6691827005067916e9*pow(eta,9) + 1.7921615360477645e9*pow(eta,10) + (-3.700118100652982 - 396.86690640576177*eta + 18114.338282695207*pow(eta,2) - 337104.2009194395*pow(eta,3) + 3.443201736241007e6*pow(eta,4) - 2.059646154246645e7*pow(eta,5) + 7.203706375607789e7*pow(eta,6) - 1.3673948189950144e8*pow(eta,7) + 1.0899165407499388e8*pow(eta,8))*pow(S,2) + (6.109672747142818 - 738.457456031227*eta + 30976.52976977678*pow(eta,2) - 585284.211668104*pow(eta,3) + 6.01428099455423e6*pow(eta,4) - 3.60069002707638e7*pow(eta,5) + 1.2566042874848208e8*pow(eta,6) - 2.3703319210223433e8*pow(eta,7) + 1.866527924066666e8*pow(eta,8))*pow(S,3) + dchi*pow(eta,2)*(dchi*(14.880608888142554 - 7.2710669385340125*S - 5.711139361901538*pow(S,2) + pow(eta,2)*(901.4037508339284 - 1045.5976728627966*S + 249.4590692061451*pow(S,2) - 489.04148050563344*pow(S,3)) + 7.364405356457336*pow(S,3) + eta*(-163.15196537422656 + 209.3327533320753*S + 36.12509984734575*pow(S,2) + 1.1180433354390895*pow(S,3)) + pow(eta,3)*(-2003.4639425904134 + 1267.304994573838*S - 1260.2745932730083*pow(S,2) + 1399.617117381689*pow(S,3))) + delta*(434.9164427760082 + 14.541749329198087*S - 84.79622663654979*pow(S,2) + eta*(499.76229427208983 - 815.9730901411959*S - 714.6533578223542*pow(S,2) - 309.99904297581014*pow(S,3)) + 27.835664851677205*pow(S,3) + pow(eta,2)*(-5371.035797592551 + 2212.0335657427336*S + 8861.10126483568*pow(S,2) + 189.56895759256398*pow(S,3)) + pow(eta,3)*(10858.881782188395 - 1113.6290906671748*S - 22779.172180739046*pow(S,2) + 2007.111395197954*pow(S,3)))) + (8.183546404235663 - 933.2988574168131*eta + 38441.38090873598*pow(eta,2) - 790826.7820518523*pow(eta,3) + 9.198943863810949e6*pow(eta,4) - 6.316519772682027e7*pow(eta,5) + 2.5340060681030166e8*pow(eta,6) - 5.487045597447982e8*pow(eta,7) + 4.951953500206205e8*pow(eta,8))*pow(S,4) + (-14.70032175268501 + 2070.837518357982*eta - 88772.16271461302*pow(eta,2) + 1.7918019772352746e6*pow(eta,3) - 1.986875946474466e7*pow(eta,4) + 1.2848321351184125e8*pow(eta,5) - 4.835629103417209e8*pow(eta,6) + 9.822067571581367e8*pow(eta,7) - 8.325116238612777e8*pow(eta,8))*pow(S,5) + (-28.216583275201305 + 3046.1601220963466*eta - 125322.27231163734*pow(eta,2) + 2.6000253362949034e6*pow(eta,3) - 3.0377668991256356e7*pow(eta,4) + 2.0861299725642124e8*pow(eta,5) - 8.347186004305689e8*pow(eta,6) + 1.7999383269611864e9*pow(eta,7) - 1.6159949975378253e9*pow(eta,8))*pow(S,6) + (26.703326295819025 - 3828.53883370726*eta + 166792.148903223*pow(eta,2) - 3.4240662720217262e6*pow(eta,3) + 3.8654692471816905e7*pow(eta,4) - 2.5447577956725535e8*pow(eta,5) + 9.744056872777345e8*pow(eta,6) - 2.0119311366646168e9*pow(eta,7) + 1.7320999776416142e9*pow(eta,8))*pow(S,7) + (45.58931376399567 - 5121.929733245828*eta + 213075.68391999506*pow(eta,2) - 4.410060823516292e6*pow(eta,3) + 5.114343638976515e7*pow(eta,4) - 3.4807212191424245e8*pow(eta,5) + 1.379981316065197e9*pow(eta,6) - 2.9492076864101434e9*pow(eta,7) + 2.6251319135709906e9*pow(eta,8))*pow(S,8) + (-16.481646372167827 + 2364.063280486912*eta - 104339.18446921211*pow(eta,2) + 2.1692615224700193e6*pow(eta,3) - 2.4781242411610477e7*pow(eta,4) + 1.6489435625265875e8*pow(eta,5) - 6.373552456680431e8*pow(eta,6) + 1.3268374422215097e9*pow(eta,7) - 1.1505022756491957e9*pow(eta,8))*pow(S,9) + (-25.630568989892318 + 3011.0471822407*eta - 127365.75761233851*pow(eta,2) + 2.6470858117977018e6*pow(eta,3) - 3.0674738039175913e7*pow(eta,4) + 2.081909604512304e8*pow(eta,5) - 8.224202188213862e8*pow(eta,6) + 1.7505671353910444e9*pow(eta,7) - 1.551625993783408e9*pow(eta,8))*pow(S,10));
  return fit;
}

static double IMRPhenomTv2_LateInspiral_CP2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 5*pow(eta,-1)*(-10.861588616105424 + 93.88462623402901*eta - 21401.362302237616*pow(eta,2) + 460874.98183952365*pow(eta,3) - 6.620285220093728e6*pow(eta,4) + 6.195355111426607e7*pow(eta,5) - 3.7863267622266316e8*pow(eta,6) + 1.5198952039712758e9*pow(eta,7) - 3.893476852936717e9*pow(eta,8) + S*(-5.472102802149199 - 673.8503397835616*eta + 27053.391020602794*pow(eta,2) - 552907.5668007057*pow(eta,3) + 6.407547273802411e6*pow(eta,4) - 4.3464647636814006e7*pow(eta,5) + 1.7112227540802714e8*pow(eta,6) - 3.6279508236626405e8*pow(eta,7) + 3.207921998532251e8*pow(eta,8)) + 5.792685505861456e9*pow(eta,9) - 3.8139839460367537e9*pow(eta,10) + (3.963699102919951 - 444.4033396131313*eta + 21729.421290721224*pow(eta,2) - 401711.4451234628*pow(eta,3) + 4.0417924256802974e6*pow(eta,4) - 2.3876662634206213e7*pow(eta,5) + 8.242514402430733e7*pow(eta,6) - 1.5380903383705163e8*pow(eta,7) + 1.1969753967305045e8*pow(eta,8))*pow(S,2) + (-16.524489071729782 + 3184.2039664828353*eta - 143618.69701330605*pow(eta,2) + 3.000407832971023e6*pow(eta,3) - 3.449808408026748e7*pow(eta,4) + 2.3160419403125563e8*pow(eta,5) - 9.050143006031996e8*pow(eta,6) + 1.9081509145367374e9*pow(eta,7) - 1.6787020681880078e9*pow(eta,8))*pow(S,3) + dchi*pow(eta,2)*(dchi*(25.174336053830416 - 58.06627967389758*S - 26.079143503295924*pow(S,2) + pow(eta,3)*(-3537.7824764560096 + 7232.342812856966*S + 2343.4404245947226*pow(S,2) - 6576.542614253396*pow(S,3)) + eta*(-372.9578586874683 + 911.4406877091859*S + 369.9324046993207*pow(S,2) - 1213.6021486962018*pow(S,3)) + 90.08165119275478*pow(S,3) + pow(eta,2)*(1971.7734458431285 - 4518.506385300145*S - 1617.930766898701*pow(S,2) + 5076.298203365232*pow(S,3))) + delta*(243.57822272743266 - 308.7535359339569*S - 165.57517082022713*pow(S,2) + pow(eta,3)*(-2164.884284264429 + 30298.26490297623*S - 7584.723587181362*pow(S,2) - 38205.310340923075*pow(S,3)) + eta*(-1666.5420283030012 + 3342.79280173065*S + 1193.4049641752351*pow(S,2) - 3723.004495887863*pow(S,3)) + 229.80264302982326*pow(S,3) + pow(eta,2)*(4654.14303317068 - 17073.766628347188*S - 277.1346791965489*pow(S,2) + 21171.386864473418*pow(S,3)))) + (8.259650281296949 - 550.1646572129637*eta + 1719.7529727548322*pow(eta,2) + 336643.24875124765*pow(eta,3) - 7.213398125623835e6*pow(eta,4) + 6.549171364261559e7*pow(eta,5) - 3.0591441541976523e8*pow(eta,6) + 7.22704153856711e8*pow(eta,7) - 6.843476107312312e8*pow(eta,8))*pow(S,4) + (88.2125948364332 - 13921.821729021874*eta + 621001.0080405677*pow(eta,2) - 1.2835529472379502e7*pow(eta,3) + 1.4603017365412658e8*pow(eta,4) - 9.703517913506848e8*pow(eta,5) + 3.751926629019194e9*pow(eta,6) - 7.821592065525896e9*pow(eta,7) + 6.796601519857938e9*pow(eta,8))*pow(S,5) + (22.7984898772897 - 5707.942792055539*eta + 335145.4237131672*pow(eta,2) - 8.2749958973485185e6*pow(eta,3) + 1.0642726529970962e8*pow(eta,4) - 7.722429480232034e8*pow(eta,5) + 3.1877433413455014e9*pow(eta,6) - 6.985326650379573e9*pow(eta,7) + 6.308568861758434e9*pow(eta,8))*pow(S,6) + (-159.97446567474628 + 25203.190495431016*eta - 1.1411181933825144e6*pow(eta,2) + 2.3943559344571408e7*pow(eta,3) - 2.7549779320182574e8*pow(eta,4) + 1.8451393623906548e9*pow(eta,5) - 7.172451411382654e9*pow(eta,6) + 1.5003299717393839e10*pow(eta,7) - 1.306207844421208e10*pow(eta,8))*pow(S,7) + (-97.68256269325309 + 18394.88434996974*eta - 946977.1132182408*pow(eta,2) + 2.171918692280097e7*pow(eta,3) - 2.6620083781198227e8*pow(eta,4) + 1.8682064626738496e9*pow(eta,5) - 7.52853775024059e9*pow(eta,6) + 1.6205422326726582e10*pow(eta,7) - 1.4439622326599413e10*pow(eta,8))*pow(S,8) + (104.3759619776244 - 16198.958281830915*eta + 739048.4508587392*pow(eta,2) - 1.5666852645528255e7*pow(eta,3) + 1.817842439445372e8*pow(eta,4) - 1.225294205915185e9*pow(eta,5) + 4.786059612657955e9*pow(eta,6) - 1.0048351128582596e10*pow(eta,7) + 8.772801442105803e9*pow(eta,8))*pow(S,9) + (84.18289399329558 - 14478.172838019495*eta + 712891.0543911399*pow(eta,2) - 1.5931056015097585e7*pow(eta,3) + 1.9182824392018214e8*pow(eta,4) - 1.3288327873978677e9*pow(eta,5) + 5.301349509343549e9*pow(eta,6) - 1.1319754061400572e10*pow(eta,7) + 1.0019819415555674e10*pow(eta,8))*pow(S,10));
  return fit;
}

static double IMRPhenomTv2_LateInspiral_CP3(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 5*pow(eta,-1)*(-5.9129809029692915 + 202.09256312118342*eta - 18704.206965990983*pow(eta,2) + 435917.52742295794*pow(eta,3) - 6.271419902203317e6*pow(eta,4) + 5.85845265825937e7*pow(eta,5) - 3.620567011807442e8*pow(eta,6) + 1.4771520087540536e9*pow(eta,7) - 3.8381773066476426e9*pow(eta,8) + S*(-0.7473327543698575 - 511.40924041682916*eta + 22101.44015876255*pow(eta,2) - 442515.6436049597*pow(eta,3) + 4.974660432029772e6*pow(eta,4) - 3.2920233239184085e7*pow(eta,5) + 1.2722573934748523e8*pow(eta,6) - 2.6593347501368162e8*pow(eta,7) + 2.32485063295994e8*pow(eta,8)) + 5.763951514299379e9*pow(eta,9) - 3.8109138108529334e9*pow(eta,10) + (3.8068987029748174 - 370.709136086869*eta + 16923.430590051426*pow(eta,2) - 309963.8435286722*pow(eta,3) + 3.0648942928781174e6*pow(eta,4) - 1.7710717497096263e7*pow(eta,5) + 5.977913705991998e7*pow(eta,6) - 1.0915045080667248e8*pow(eta,7) + 8.31593534176514e7*pow(eta,8))*pow(S,2) + (-14.618748181564397 + 2640.73420107876*eta - 116629.6667352759*pow(eta,2) + 2.3667745199154713e6*pow(eta,3) - 2.6457776135230754e7*pow(eta,4) + 1.7329028227617255e8*pow(eta,5) - 6.629555290649103e8*pow(eta,6) + 1.3725769155924544e9*pow(eta,7) - 1.1885604734571214e9*pow(eta,8))*pow(S,3) + dchi*pow(eta,2)*(dchi*(15.05781275863717 - 46.2105330382699*S - 8.266535528660583*pow(S,2) + pow(eta,3)*(-2557.554908863586 + 5482.992873013478*S + 607.3325602169028*pow(S,2) - 4532.388284666797*pow(S,3)) + eta*(-251.44711776338858 + 705.5125041986546*S + 123.52396631036976*pow(S,2) - 811.9367699761842*pow(S,3)) + 59.75197426846798*pow(S,3) + pow(eta,2)*(1403.7219403593583 - 3451.513841677734*S - 497.1589647602453*pow(S,2) + 3426.315715989988*pow(S,3))) + delta*(100.77519171905257 - 215.70347997540006*S - 36.365338886464066*pow(S,2) + pow(eta,3)*(952.0304524327831 + 22047.606237215954*S - 9073.711129029332*pow(S,2) - 18921.99439949057*pow(S,3)) + eta*(-721.34846339271 + 2622.6455302195877*S - 38.730364051377556*pow(S,2) - 2165.3922875728513*pow(S,3)) + 143.6230643138346*pow(S,3) + pow(eta,2)*(1436.7133253641368 - 13086.456853477475*S + 3141.0429228229345*pow(S,2) + 11410.703412773175*pow(S,3)))) + (5.377400320605292 - 443.9225010723286*eta + 4075.6313119265365*pow(eta,2) + 173995.16738115906*pow(eta,3) - 4.355259788116693e6*pow(eta,4) + 4.157248474200218e7*pow(eta,5) - 1.9992482472720003e8*pow(eta,6) + 4.8259460100871265e8*pow(eta,7) - 4.6525497745644325e8*pow(eta,8))*pow(S,4) + (65.33577069829586 - 10366.011235398888*eta + 456350.74010166916*pow(eta,2) - 9.281736946463652e6*pow(eta,3) + 1.0400233719472902e8*pow(eta,4) - 6.818820072629106e8*pow(eta,5) + 2.606067792784801e9*pow(eta,6) - 5.377786277569439e9*pow(eta,7) + 4.630729136316392e9*pow(eta,8))*pow(S,5) + (4.63802842610338 - 2110.6914451800926*eta + 155997.5963853255*pow(eta,2) - 4.2912182984774485e6*pow(eta,3) + 5.87962618829819e7*pow(eta,4) - 4.450885126518593e8*pow(eta,5) + 1.895484604639373e9*pow(eta,6) - 4.2569018043216033e9*pow(eta,7) + 3.923332888666623e9*pow(eta,8))*pow(S,6) + (-114.76447084311599 + 18168.180820766564*eta - 813968.3197187929*pow(eta,2) + 1.6870206260134984e7*pow(eta,3) - 1.9198832434723464e8*pow(eta,4) + 1.2738816184138377e9*pow(eta,5) - 4.9124711516358e9*pow(eta,6) + 1.0204266581691011e10*pow(eta,7) - 8.828103984405533e9*pow(eta,8))*pow(S,7) + (-43.68967805820703 + 8888.098536392172*eta - 493680.7279001613*pow(eta,2) + 1.1901620650257632e7*pow(eta,3) - 1.510526562535436e8*pow(eta,4) + 1.0883643934245913e9*pow(eta,5) - 4.479382521756102e9*pow(eta,6) + 9.813801605436556e9*pow(eta,7) - 8.878991022564905e9*pow(eta,8))*pow(S,8) + (73.87648917468061 - 11595.058299730596*eta + 524892.4423563383*pow(eta,2) - 1.1018527099526135e7*pow(eta,3) + 1.2675190934539577e8*pow(eta,4) - 8.482285917747663e8*pow(eta,5) + 3.2931660906437073e9*pow(eta,6) - 6.8776712226708e9*pow(eta,7) + 5.976298718601541e9*pow(eta,8))*pow(S,9) + (42.09355664510681 - 7516.502773578052*eta + 386581.2179854606*pow(eta,2) - 8.917019474130858e6*pow(eta,3) + 1.0995638620150769e8*pow(eta,4) - 7.762707345141464e8*pow(eta,5) + 3.1464111430723476e9*pow(eta,6) - 6.811226843530259e9*pow(eta,7) + 6.102856802535321e9*pow(eta,8))*pow(S,10));
  return fit;
}


static double IMRPhenomTv2_LateInspiral_CP4(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 5*pow(eta,-1)*(-2.8459971098340815 + 141.393391145589*eta - 11774.93973679817*pow(eta,2) + 280485.99489364243*pow(eta,3) - 4.0300465480264765e6*pow(eta,4) + 3.745102008523106e7*pow(eta,5) - 2.3066347082271373e8*pow(eta,6) + 9.387601203832197e8*pow(eta,7) - 2.432417783314343e9*pow(eta,8) + S*(0.21417519915690292 - 303.3300412851984*eta + 13258.990719789863*pow(eta,2) - 264055.4714465883*pow(eta,3) + 2.9325884179853043e6*pow(eta,4) - 1.9176485637718275e7*pow(eta,5) + 7.33830383440535e7*pow(eta,6) - 1.521756822497174e8*pow(eta,7) + 1.3216761202910127e8*pow(eta,8)) + 3.6395282693915496e9*pow(eta,9) - 2.395355249793461e9*pow(eta,10) + (2.0002421434185385 - 205.64022134484597*eta + 9045.792330106025*pow(eta,2) - 161003.11365572442*pow(eta,3) + 1.5370819664460795e6*pow(eta,4) - 8.531744675781395e6*pow(eta,5) + 2.7532098760235358e7*pow(eta,6) - 4.777185047373032e7*pow(eta,7) + 3.4274090973671116e7*pow(eta,8))*pow(S,2) + (-9.57887114489333 + 1681.1480191952585*eta - 73972.42731754821*pow(eta,2) + 1.4928772163973767e6*pow(eta,3) - 1.6595365568442985e7*pow(eta,4) + 1.081699796584991e8*pow(eta,5) - 4.122003828785852e8*pow(eta,6) + 8.507274663922782e8*pow(eta,7) - 7.347970091079464e8*pow(eta,8))*pow(S,3) + dchi*pow(eta,2)*(dchi*(5.504017906408484 - 29.006731584007415*S - 0.1331014656674637*pow(S,2) + pow(eta,3)*(-1100.5247504123975 + 3230.5256094507135*S - 101.7729812706254*pow(S,2) - 2394.4155638497837*pow(S,3)) + eta*(-100.63790479299749 + 431.9280438459471*S + 7.510087044418604*pow(S,2) - 460.24065568519325*pow(S,3)) + 34.57410015596462*pow(S,3) + pow(eta,2)*(589.8491094021769 - 2071.470910989713*S + 5.912190721414289*pow(S,2) + 1890.657082620979*pow(S,3))) + delta*(42.27059791192687 - 103.27760875055104*S - 1.1920421203074572*pow(S,2) + pow(eta,3)*(1300.4850396541558 + 10680.860918443066*S - 6292.048118168806*pow(S,2) - 7060.573096554191*pow(S,3)) + eta*(-268.4579920056673 + 1292.7639962577866*S - 256.596620666769*pow(S,2) - 874.6234496786013*pow(S,3)) + 59.38642234593035*pow(S,3) + pow(eta,2)*(227.1112629391048 - 6428.641933960439*S + 2689.654945956176*pow(S,2) + 4494.468701574622*pow(S,3)))) + (5.061720473940852 - 595.7475839994935*eta + 18090.77768084942*pow(eta,2) - 239952.5540721117*pow(eta,3) + 1.4941563241688323e6*pow(eta,4) - 3.302948883937741e6*pow(eta,5) - 7.807192967791875e6*pow(eta,6) + 5.054367827945445e7*pow(eta,7) - 6.735520147794974e7*pow(eta,8))*pow(S,4) + (39.704464842637314 - 6330.617205443372*eta + 278460.1562704981*pow(eta,2) - 5.656247838177008e6*pow(eta,3) + 6.332209943966035e7*pow(eta,4) - 4.151035611118656e8*pow(eta,5) + 1.5874680448764677e9*pow(eta,6) - 3.2801613819566097e9*pow(eta,7) + 2.8298649030786557e9*pow(eta,8))*pow(S,5) + (-9.43173719710008 + 685.6593995773567*eta + 5385.088671809452*pow(eta,2) - 712961.0280665975*pow(eta,3) + 1.3719817518628621e7*pow(eta,4) - 1.2167710111908638e8*pow(eta,5) + 5.675431490374448e8*pow(eta,6) - 1.3505354870422692e9*pow(eta,7) + 1.2939832827109103e9*pow(eta,8))*pow(S,6) + (-69.12699338619426 + 10977.102430132467*eta - 490867.98329933*pow(eta,2) + 1.0154662345534036e7*pow(eta,3) - 1.1544125091535093e8*pow(eta,4) + 7.658851573099471e8*pow(eta,5) - 2.955643976595212e9*pow(eta,6) + 6.148406355662914e9*pow(eta,7) - 5.330086462990024e9*pow(eta,8))*pow(S,7) + (-2.933243049110335 + 1641.9366332281875*eta - 130250.32886434703*pow(eta,2) + 3.6595231242367453e6*pow(eta,3) - 5.0522738136196e7*pow(eta,4) + 3.836187428847597e8*pow(eta,5) - 1.6352428913185775e9*pow(eta,6) + 3.671343906411541e9*pow(eta,7) - 3.379899892913296e9*pow(eta,8))*pow(S,8) + (44.140806904646034 - 6960.843348208193*eta + 314228.158504166*pow(eta,2) - 6.576462556444786e6*pow(eta,3) + 7.549788988418378e7*pow(eta,4) - 5.047271420359926e8*pow(eta,5) + 1.9593366260373394e9*pow(eta,6) - 4.094529286159352e9*pow(eta,7) + 3.5621796422923903e9*pow(eta,8))*pow(S,9) + (11.002204108743186 - 2269.470141057169*eta + 131127.60839105735*pow(eta,2) - 3.2338209809292005e6*pow(eta,3) + 4.1589014256045125e7*pow(eta,4) - 3.020569581586019e8*pow(eta,5) + 1.2490139086617503e9*pow(eta,6) - 2.743024939582572e9*pow(eta,7) + 2.483551452580825e9*pow(eta,8))*pow(S,10));
  return fit;
}


static double IMRPhenomTv2_LateInspiral_CP5(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 5*pow(eta,-1)*(-1.09666057545081 + 55.94997471306099*eta - 5573.9533656416115*pow(eta,2) + 134978.05230709355*pow(eta,3) - 1.9419684728123308e6*pow(eta,4) + 1.79283101506857e7*pow(eta,5) - 1.0922343155320196e8*pow(eta,6) + 4.3831530154292464e8*pow(eta,7) - 1.1170855873121421e9*pow(eta,8) + S*(0.1101165882730758 - 123.23701971949312*eta + 5288.668116815526*pow(eta,2) - 103541.4225479654*pow(eta,3) + 1.1289851964890512e6*pow(eta,4) - 7.255777967564194e6*pow(eta,5) + 2.735164665878698e7*pow(eta,6) - 5.601199952036098e7*pow(eta,7) + 4.814715318817861e7*pow(eta,8)) + 1.6408855793068502e9*pow(eta,9) - 1.0586793901400689e9*pow(eta,10) + (0.5138070970526448 - 63.37701235166244*eta + 2999.3995626837313*pow(eta,2) - 54535.76366409521*pow(eta,3) + 528100.8081131536*pow(eta,4) - 2.967350621675273e6*pow(eta,5) + 9.68743896892683e6*pow(eta,6) - 1.7008421938972287e7*pow(eta,7) + 1.2360317671395035e7*pow(eta,8))*pow(S,2) + (-4.76954741209028 + 824.872832881423*eta - 36103.99701411935*pow(eta,2) + 723107.2042885011*pow(eta,3) - 7.96198511654506e6*pow(eta,4) + 5.13767572396848e7*pow(eta,5) - 1.9385485585975876e8*pow(eta,6) + 3.9632479815077984e8*pow(eta,7) - 3.3924346057066804e8*pow(eta,8))*pow(S,3) + dchi*pow(eta,2)*(dchi*(2.086699900410677 - 9.6575159722962*S + 0.4815161226323205*pow(S,2) + pow(eta,3)*(-355.01918060819463 + 1150.6991126163896*S - 27.848503259130982*pow(S,2) - 811.3734929835434*pow(S,3)) + eta*(-34.563667763805604 + 145.30490860946762*S - 5.6723877635419635*pow(S,2) - 153.46357275958914*pow(S,3)) + 11.610971896134796*pow(S,3) + pow(eta,2)*(194.02789777277724 - 714.1441642131459*S + 26.643341849016014*pow(S,2) + 632.4187287744571*pow(S,3))) + delta*(17.185412685836212 - 35.28234500460066*S + 0.7755414983573784*pow(S,2) + pow(eta,3)*(343.34898059021367 + 3622.067990546189*S - 2960.984072813806*pow(S,2) - 2562.1349640891785*pow(S,3)) + eta*(-111.8887313010544 + 437.249209988561*S - 133.10999148277298*pow(S,2) - 250.70403107577852*pow(S,3)) + 14.906409861828516*pow(S,3) + pow(eta,2)*(151.97099306799265 - 2183.419863134354*S + 1273.2608377379925*pow(S,2) + 1472.8843343725825*pow(S,3)))) + (3.0788262684311603 - 376.6650885520761*eta + 11967.827082727996*pow(eta,2) - 167889.52562751758*pow(eta,3) + 1.1598636317243031e6*pow(eta,4) - 3.565788715724415e6*pow(eta,5) + 422077.5834259897*pow(eta,6) + 2.252233245416187e7*pow(eta,7) - 3.670357746583186e7*pow(eta,8))*pow(S,4) + (19.44452466282177 - 3100.9600663366846*eta + 136325.29946451721*pow(eta,2) - 2.763933714650141e6*pow(eta,3) + 3.0844147049927898e7*pow(eta,4) - 2.0144871386395478e8*pow(eta,5) + 7.674797357407366e8*pow(eta,6) - 1.5799558201639872e9*pow(eta,7) + 1.3581648525696042e9*pow(eta,8))*pow(S,5) + (-6.890527706782045 + 689.2690501838239*eta - 11837.346507164852*pow(eta,2) - 74495.55242797257*pow(eta,3) + 3.862125273133607e6*pow(eta,4) - 4.237582364135357e7*pow(eta,5) + 2.1825893053834167e8*pow(eta,6) - 5.514347333005565e8*pow(eta,7) + 5.509150856048709e8*pow(eta,8))*pow(S,6) + (-33.72209140031915 + 5338.971470967145*eta - 238706.26467419454*pow(eta,2) + 4.935756422287273e6*pow(eta,3) - 5.604563678446097e7*pow(eta,4) + 3.712866605599051e8*pow(eta,5) - 1.4306546323718784e9*pow(eta,6) + 2.9716063606019096e9*pow(eta,7) - 2.572333583261061e9*pow(eta,8))*pow(S,7) + (3.6309866576017322 + 5.675883340901152*eta - 29664.02029808914*pow(eta,2) + 1.1127155492881655e6*pow(eta,3) - 1.7302353099092234e7*pow(eta,4) + 1.4037273838959202e8*pow(eta,5) - 6.246776655773894e8*pow(eta,6) + 1.4463529781046355e9*pow(eta,7) - 1.3633164944557562e9*pow(eta,8))*pow(S,8) + (21.567091196686796 - 3391.068176784628*eta + 152974.5817432195*pow(eta,2) - 3.1992018581743343e6*pow(eta,3) + 3.668889001493144e7*pow(eta,4) - 2.450014364719308e8*pow(eta,5) + 9.500369170346507e8*pow(eta,6) - 1.98323777805955e9*pow(eta,7) + 1.723637333277433e9*pow(eta,8))*pow(S,9) + (1.9087995676926213 - 563.6981671364354*eta + 40421.53015471166*pow(eta,2) - 1.1018543162110602e6*pow(eta,3) + 1.5002439108863583e7*pow(eta,4) - 1.1308049417092419e8*pow(eta,5) + 4.8005809991514814e8*pow(eta,6) - 1.0753857645105672e9*pow(eta,7) + 9.889980706478518e8*pow(eta,8))*pow(S,10));
  return fit;
}


static double IMRPhenomTv2_LateInspiral_CP6(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 5*pow(eta,-1)*(-0.2118032992427691 - 11.082814791925099*eta - 1098.49040770457*pow(eta,2) + 26916.14473500188*pow(eta,3) - 395891.89024104027*pow(eta,4) + 3.787179810567934e6*pow(eta,5) - 2.41341290874842e7*pow(eta,6) + 1.0189950047932342e8*pow(eta,7) - 2.740995763215661e8*pow(eta,8) + S*(0.17789950308508495 - 55.218873464943876*eta + 2360.748221201656*pow(eta,2) - 47500.10141098428*pow(eta,3) + 532134.9369766713*pow(eta,4) - 3.4988705649270783e6*pow(eta,5) + 1.3430164471574971e7*pow(eta,6) - 2.7875982439252827e7*pow(eta,7) + 2.4184656499861617e7*pow(eta,8)) + 4.2550572870769155e8*pow(eta,9) - 2.9016093361326647e8*pow(eta,10) + (0.32931696502881436 - 56.05775341473361*eta + 2410.807858255926*pow(eta,2) - 44006.270600450924*pow(eta,3) + 438924.2511517998*pow(eta,4) - 2.5834730670134556e6*pow(eta,5) + 8.972423676126713e6*pow(eta,6) - 1.702447537686519e7*pow(eta,7) + 1.361357438048048e7*pow(eta,8))*pow(S,2) + (-1.8398845004459374 + 302.5437667853358*eta - 13162.109729258244*pow(eta,2) + 263541.98378059507*pow(eta,3) - 2.905127531572429e6*pow(eta,4) + 1.877254828967905e7*pow(eta,5) - 7.092817743881713e7*pow(eta,6) + 1.451842461712779e8*pow(eta,7) - 1.2440966534847164e8*pow(eta,8))*pow(S,3) + dchi*pow(eta,2)*(dchi*(1.2705713566998993 - 5.448043576342409*S + 0.003939891977131546*pow(S,2) + pow(eta,3)*(-362.08282603977585 + 509.1921719333087*S + 10.633090510650058*pow(S,2) - 438.2921965429143*pow(S,3)) + eta*(-28.07506060140762 + 77.45783167052376*S + 4.610015119417979*pow(S,2) - 70.71839273288836*pow(S,3)) + 5.231745662114188*pow(S,3) + pow(eta,2)*(181.79428579019398 - 351.07743872485463*S - 21.260837806291025*pow(S,2) + 306.09500691604*pow(S,3))) + delta*(2.3211684250024263 - 12.751717709448787*S + 5.008767110711494*pow(S,2) + pow(eta,3)*(1000.0403636641839 + 1500.4527265302754*S - 1259.429239979068*pow(S,2) - 487.42116861825315*pow(S,3)) + eta*(32.89094324929191 + 172.35525138125044*S - 116.41028488490534*pow(S,2) - 98.51605115939238*pow(S,3)) + 7.284379477313318*pow(S,3) + pow(eta,2)*(-393.0121393910552 - 904.0540779858155*S + 728.4992967344657*pow(S,2) + 439.3825301090415*pow(S,3)))) + (0.08697235931315798 + 17.90778935584966*eta - 1981.5040397929968*pow(eta,2) + 57639.01122572711*pow(eta,3) - 804711.7932101559*pow(eta,4) + 6.148851322881119e6*pow(eta,5) - 2.630262233892876e7*pow(eta,6) + 5.91033549076359e7*pow(eta,7) - 5.429998698252353e7*pow(eta,8))*pow(S,4) + (7.198920060350895 - 1139.3697177965294*eta + 50127.81221785188*pow(eta,2) - 1.0180751707279994e6*pow(eta,3) + 1.1381433787875837e7*pow(eta,4) - 7.446090095561332e7*pow(eta,5) + 2.8415446972969115e8*pow(eta,6) - 5.859481189831444e8*pow(eta,7) + 5.045551792509136e8*pow(eta,8))*pow(S,5) + (0.017166579609402773 - 104.25877563745276*eta + 10594.504997363692*pow(eta,2) - 318331.09489021153*pow(eta,3) + 4.536726719621083e6*pow(eta,4) - 3.5069425911417164e7*pow(eta,5) + 1.5110033536646253e8*pow(eta,6) - 3.4142206224748677e8*pow(eta,7) + 3.1541998883142996e8*pow(eta,8))*pow(S,6) + (-12.176055986732832 + 1921.5557449950613*eta - 86162.82399654991*pow(eta,2) + 1.7869975202310688e6*pow(eta,3) - 2.034278249930796e7*pow(eta,4) + 1.350438269067178e8*pow(eta,5) - 5.212567372473238e8*pow(eta,6) + 1.0843275563888886e9*pow(eta,7) - 9.398973649518406e8*pow(eta,8))*pow(S,7) + (-2.773440653539044 + 580.7014650593019*eta - 35736.59388916027*pow(eta,2) + 908662.6507445434*pow(eta,3) - 1.188965465649403e7*pow(eta,4) + 8.727570483876224e7*pow(eta,5) - 3.633783794664601e8*pow(eta,6) + 8.017197579080112e8*pow(eta,7) - 7.28158925394023e8*pow(eta,8))*pow(S,8) + (7.787467203047512 - 1222.2813461016178*eta + 55337.3664063071*pow(eta,2) - 1.1613164898568664e6*pow(eta,3) + 1.335585248856335e7*pow(eta,4) - 8.939273605105616e7*pow(eta,5) + 3.4730522483045644e8*pow(eta,6) - 7.262346049212208e8*pow(eta,7) + 6.321322720867321e8*pow(eta,8))*pow(S,9) + (3.18336457991897 - 564.667609128838*eta + 30426.785740698684*pow(eta,2) - 722619.4786433709*pow(eta,3) + 9.07444580259646e6*pow(eta,4) - 6.4812286716714e7*pow(eta,5) + 2.6464205974256375e8*pow(eta,6) - 5.754474167154106e8*pow(eta,7) + 5.168259711028571e8*pow(eta,8))*pow(S,10));
  return fit;
}

/** Merger 22 frequency collocation points **/

static double IMRPhenomTv2_Merger_CP1(double eta, double S, double dchi, double delta)
{
  double fit;

  /*fit = -59.747397007655884 + 4018.782490670864*eta - 223522.3465479424*pow(eta,2) + 6.172706430900392e6*pow(eta,3) - 1.0245445393372412e8*pow(eta,4) + 1.1118591879133537e9*pow(eta,5) - 8.196326223609657e9*pow(eta,6) + S*(-1.4913514360932705 - 459.8517210892352*eta + 11151.547879198857*pow(eta,2) - 121572.05252458726*pow(eta,3) + 679624.0769906277*pow(eta,4) - 1.9027862335306262e6*pow(eta,5) + 2.1181685723250667e6*pow(eta,6)) + 4.147338356698428e10*pow(eta,7) - 1.4210641053322513e11*pow(eta,8) + 3.1546309258231824e11*pow(eta,9) - 4.09704287848923e11*pow(eta,10) + 2.3644134103957043e11*pow(eta,11) + (-7.235150533434589 + 314.9164561215511*eta - 7913.27484819671*pow(eta,2) + 87082.69545893188*pow(eta,3) - 469130.80503929296*pow(eta,4) + 1.2363005142896175e6*pow(eta,5) - 1.2857547279064786e6*pow(eta,6))*pow(S,2) + (2.5939391478422458 - 1074.6340681072336*eta + 28595.328917885003*pow(eta,2) - 323728.4397023884*pow(eta,3) + 1.8267519003202664e6*pow(eta,4) - 5.030970016847074e6*pow(eta,5) + 5.381751658058725e6*pow(eta,6))*pow(S,3) + dchi*pow(eta,2)*(dchi*(-16.481564418328656 + 20.40834541299926*S + 108.9272278260816*pow(S,2) + pow(eta,2)*(729.9529897875303 - 547.6073769696834*S + 6407.611246759203*pow(S,2) - 14002.902265885257*pow(S,3)) - 84.6428815623208*pow(S,3) + eta*(0.852025680726935 - 51.5128701194615*S - 1341.4990896000463*pow(S,2) + 1947.8217753589706*pow(S,3)) + pow(eta,3)*(-1932.5681442570517 + 1695.6044152938744*S - 11312.733903382112*pow(S,2) + 31248.61691137766*pow(S,3))) + delta*(344.4063253825867 + 127.04316347917049*S - 509.2442331843243*pow(S,2) + pow(eta,2)*(20667.558377576468 + 0.5618220194746976*S - 21905.924957722094*pow(S,2) - 66813.8287240998*pow(S,3)) - 858.3874404308664*pow(S,3) + eta*(-4365.283573527586 - 701.4488472971929*S + 6167.6075844704965*pow(S,2) + 12872.902808379655*pow(S,3)) + pow(eta,3)*(-32552.227826616217 + 3669.96253002093*S + 19587.643888628772*pow(S,2) + 117798.27859852083*pow(S,3)))) + (-1.221504717195497 - 315.96223441205774*eta + 11951.298630818499*pow(eta,2) - 176618.30484561098*pow(eta,3) + 1.209425836640069e6*pow(eta,4) - 3.8940342920447187e6*pow(eta,5) + 4.795279987040242e6*pow(eta,6))*pow(S,4) + (-70.47388029968299 + 8069.249554066373*eta - 205008.0919841009*pow(eta,2) + 2.2822108657389036e6*pow(eta,3) - 1.2752816087087478e7*pow(eta,4) + 3.5113061111343846e7*pow(eta,5) - 3.79552951065836e7*pow(eta,6))*pow(S,5) + (-8.646351196600332 + 1646.9064149623512*eta - 50093.84689290193*pow(eta,2) + 653985.985639166*pow(eta,3) - 4.1838559216981423e6*pow(eta,4) + 1.293842977626363e7*pow(eta,5) - 1.5485562938566856e7*pow(eta,6))*pow(S,6) + (108.47681404408924 - 11857.60448988602*eta + 306100.3540104212*pow(eta,2) - 3.4408119325703084e6*pow(eta,3) + 1.9309948438203912e7*pow(eta,4) - 5.325996877761571e7*pow(eta,5) + 5.762476802892821e7*pow(eta,6))*pow(S,7) + (-0.6289791558501517 - 769.6447581243224*eta + 28542.682573141687*pow(eta,2) - 401817.4144253289*pow(eta,3) + 2.6731546219092435e6*pow(eta,4) - 8.460005537177159e6*pow(eta,5) + 1.0265867361757813e7*pow(eta,6))*pow(S,8) + (-61.24026677282459 + 6360.268128554734*eta - 165042.23471843917*pow(eta,2) + 1.8599286205024342e6*pow(eta,3) - 1.0428379225506881e7*pow(eta,4) + 2.8673471709097933e7*pow(eta,5) - 3.0885693440441508e7*pow(eta,6))*pow(S,9);*/
  fit = -59.747397007655884 + 4018.782490670864*eta - 223522.3465479424*pow(eta,2) + 6.172706430900392e6*pow(eta,3) - 1.0245445393372412e8*pow(eta,4) + 1.1118591879133537e9*pow(eta,5) - 8.196326223609657e9*pow(eta,6) + S*(-0.9979611772313317 - 495.40371676755876*eta + 11998.367941149263*pow(eta,2) - 130901.2940439354*pow(eta,3) + 731955.8136654749*pow(eta,4) - 2.0482977812542305e6*pow(eta,5) + 2.27756027607502e6*pow(eta,6)) + 4.147338356698428e10*pow(eta,7) - 1.4210641053322513e11*pow(eta,8) + 3.1546309258231824e11*pow(eta,9) - 4.09704287848923e11*pow(eta,10) + 2.3644134103957043e11*pow(eta,11) + (-8.124535133820794 + 415.4685428327168*eta - 10322.804808956169*pow(eta,2) + 111877.25700792877*pow(eta,3) - 596532.2177045686*pow(eta,4) + 1.5588357212681586e6*pow(eta,5) - 1.606789329651285e6*pow(eta,6))*pow(S,2) + (-6.916178541884052 - 330.942809816399*eta + 10457.836016776373*pow(eta,2) - 122568.11023025129*pow(eta,3) + 698574.7577442288*pow(eta,4) - 1.9050501567689271e6*pow(eta,5) + 1.975517942777691e6*pow(eta,6))*pow(S,3) + pow(eta,2)*(pow(dchi,2)*(-15.075029062864864 - 22.414751672542195*eta + 848.7515186776903*pow(eta,2) - 2125.370198381841*pow(eta,3)) + S*pow(dchi,2)*(11.807163906065393 + 95.22420106122736*eta - 1344.9022080876807*pow(eta,2) + 3086.53177240683*pow(eta,3)) + pow(dchi,2)*(106.95898018385498 - 1312.2710958011178*eta + 6286.016947651086*pow(eta,2) - 11171.555357938847*pow(eta,3))*pow(S,2) + pow(dchi,2)*(-61.42651247480658 + 1534.6808812539532*eta - 11655.808859309202*pow(eta,2) + 26981.979916425804*pow(eta,3))*pow(S,3) + delta*(dchi*(347.58714549016486 - 4420.6268914539805*eta + 20971.470561404396*pow(eta,2) - 33077.09969097128*pow(eta,3)) + dchi*S*(128.67867877012398 - 747.3738365240167*eta + 376.3306971975508*pow(eta,2) + 2775.3331045717687*pow(eta,3)) + dchi*(-524.2822248216828 + 6457.451433204113*eta - 23676.409461739295*pow(eta,2) + 22985.029181152753*pow(eta,3))*pow(S,2) + dchi*(-877.6599343255247 + 13282.566422028018*eta - 69587.33021182315*pow(eta,2) + 123679.00341573045*pow(eta,3))*pow(S,3))) + (8.64911573800982 - 1492.3236088191406*eta + 40612.93367996793*pow(eta,2) - 475498.2048636246*pow(eta,3) + 2.765561834320603e6*pow(eta,4) - 7.888866374578551e6*pow(eta,5) + 8.831391012278192e6*pow(eta,6))*pow(S,4) + (-21.203346088869587 + 3821.275142282958*eta - 98856.9054049539*pow(eta,2) + 1.0970986294342394e6*pow(eta,3) - 6.106129388340347e6*pow(eta,4) + 1.675248928631107e7*pow(eta,5) - 1.8040491955463044e7*pow(eta,6))*pow(S,5) + (-38.2817914460069 + 5304.000373195919*eta - 140122.32113523656*pow(eta,2) + 1.6003656859123176e6*pow(eta,3) - 9.149856786951633e6*pow(eta,4) + 2.5790057973429993e7*pow(eta,5) - 2.8580262730387446e7*pow(eta,6))*pow(S,6) + (13.595955627320395 - 2826.407180019608*eta + 75570.46690543508*pow(eta,2) - 853010.5919730904*pow(eta,3) + 4.796706051201424e6*pow(eta,4) - 1.3269635187563172e7*pow(eta,5) + 1.441401602206594e7*pow(eta,6))*pow(S,7) + (24.98514300019551 - 3994.7192408952383*eta + 108373.7558586233*pow(eta,2) - 1.2444521551165066e6*pow(eta,3) + 7.112013308533808e6*pow(eta,4) - 1.9992994558653746e7*pow(eta,5) + 2.2065341102830768e7*pow(eta,6))*pow(S,8);
  return fit;
}

static double IMRPhenomTv2_Merger_CP2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = -43.166041694520096 + 4630.973557193919*eta - 254498.59024436236*pow(eta,2) + 7.025856842019377e6*pow(eta,3) - 1.1679773335753672e8*pow(eta,4) + 1.2692754438396826e9*pow(eta,5) - 9.363519115812248e9*pow(eta,6) + S*(-0.7545349379098414 - 345.7532438374342*eta + 9250.463481590463*pow(eta,2) - 106021.039160247*pow(eta,3) + 608566.1764146116*pow(eta,4) - 1.7290110096871995e6*pow(eta,5) + 1.94094423556311e6*pow(eta,6)) + 4.737841680426244e10*pow(eta,7) - 1.6222446886144724e11*pow(eta,8) + 3.5965171888171204e11*pow(eta,9) - 4.6624431329587427e11*pow(eta,10) + 2.6846566761126535e11*pow(eta,11) + (-2.8164521461850622 + 262.3891251524896*eta - 7591.398147003056*pow(eta,2) + 85717.55607140914*pow(eta,3) - 463593.731290111*pow(eta,4) + 1.2160664918659863e6*pow(eta,5) - 1.2515178107645004e6*pow(eta,6))*pow(S,2) + (9.09846313212724 - 781.2804234058617*eta + 16126.08929318426*pow(eta,2) - 165706.08896634652*pow(eta,3) + 903791.6673870486*pow(eta,4) - 2.4530339256013306e6*pow(eta,5) + 2.5888595000437098e6*pow(eta,6))*pow(S,3) + dchi*pow(eta,2)*(dchi*(-10.610425279999278 - 19.915434844351278*S + 68.57738220179054*pow(S,2) + pow(eta,2)*(756.9233550441093 - 2031.9167884044684*S + 3515.026484086803*pow(S,2) - 18404.793176130654*pow(S,3)) - 99.56882498484977*pow(S,3) + eta*(-36.72346716509764 + 382.19497806388176*S - 772.7308467785016*pow(S,2) + 2527.809275992928*pow(S,3)) + pow(eta,3)*(-1781.4202050928184 + 3249.397944087463*S - 6189.152615211074*pow(S,2) + 40609.712356550655*pow(S,3))) + delta*(249.23988057674288 + 42.06869423009331*S - 230.4024413975484*pow(S,2) + pow(eta,2)*(14872.446184911845 - 4005.8980971830874*S + 273.6107200119261*pow(S,2) - 37451.10684457142*pow(S,3)) - 510.8311857022574*pow(S,3) + eta*(-3227.807937586875 + 288.06828387402624*S + 1904.0153583253225*pow(S,2) + 7484.524788918985*pow(S,3)) + pow(eta,3)*(-22659.53829664923 + 9324.809435162579*S - 18319.189634963142*pow(S,2) + 63621.79859746116*pow(S,3)))) + (-9.528100121996088 - 89.53751403626313*eta + 8029.179405846998*pow(eta,2) - 128397.7968234331*pow(eta,3) + 868200.3693411232*pow(eta,4) - 2.701784619047875e6*pow(eta,5) + 3.2070092208994944e6*pow(eta,6))*pow(S,4) + (-91.18505809427461 + 6688.643442414258*eta - 151667.26133976574*pow(eta,2) + 1.6270762608511343e6*pow(eta,3) - 9.017442138874728e6*pow(eta,4) + 2.4899063033516437e7*pow(eta,5) - 2.7094942615880482e7*pow(eta,6))*pow(S,5) + (13.643475197713613 + 120.69046317194662*eta - 10330.839301034424*pow(eta,2) + 160015.1645833476*pow(eta,3) - 1.0593637011615597e6*pow(eta,4) + 3.2527764406714076e6*pow(eta,5) - 3.830495911423599e6*pow(eta,6))*pow(S,6) + (155.94833161439513 - 11281.465739299138*eta + 265043.29131493*pow(eta,2) - 2.9266108465582314e6*pow(eta,3) + 1.6567384153436884e7*pow(eta,4) - 4.652148064366714e7*pow(eta,5) + 5.1370594235426165e7*pow(eta,6))*pow(S,7) + (-13.858057754196093 + 258.4097710907808*eta - 1240.9582243845084*pow(eta,2) - 9014.230111120716*pow(eta,3) + 102899.42406334415*pow(eta,4) - 333552.3302308894*pow(eta,5) + 370906.65506771946*pow(eta,6))*pow(S,8) + (-89.43830738380144 + 6495.775271109077*eta - 157649.34497007105*pow(eta,2) + 1.7837022360863832e6*pow(eta,3) - 1.027101100464482e7*pow(eta,4) + 2.920031250796929e7*pow(eta,5) - 3.254843310652461e7*pow(eta,6))*pow(S,9);
  return fit;
}

static double IMRPhenomTv2_Merger_CP3(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = -21.183506716623548 + 2533.5085447370075*eta - 139039.49622254807*pow(eta,2) + 3.840258164582454e6*pow(eta,3) - 6.3847366541995615e7*pow(eta,4) + 6.935231378332064e8*pow(eta,5) - 5.111118608157518e9*pow(eta,6) + S*(-1.1188479835557616 - 142.01177411647203*eta + 4329.221865583582*pow(eta,2) - 51388.713057395384*pow(eta,3) + 297121.9776003765*pow(eta,4) - 841627.3078960505*pow(eta,5) + 938340.5296185209*pow(eta,6)) + 2.5825050811941288e10*pow(eta,7) - 8.826848709003844e10*pow(eta,8) + 1.952859571065862e11*pow(eta,9) - 2.5257569091814764e11*pow(eta,10) + 1.4506337279060187e11*pow(eta,11) + (0.378059815122336 + 145.2562011041167*eta - 4748.471284434694*pow(eta,2) + 54440.08197112477*pow(eta,3) - 294644.9017349172*pow(eta,4) + 769072.2166961373*pow(eta,5) - 783349.7868606778*pow(eta,6))*pow(S,2) + (9.923380909014199 - 360.31077062229934*eta + 4518.898673778509*pow(eta,2) - 34838.55354220883*pow(eta,3) + 176399.0137161793*pow(eta,4) - 491757.81433733506*pow(eta,5) + 544120.5536869796*pow(eta,6))*pow(S,3) + dchi*pow(eta,2)*(delta*(112.01724008839612 - 10.878747194597238*S + 45.665146479079745*pow(S,2) + pow(eta,2)*(5900.091764071419 - 4255.1852453559995*S + 17297.525614516482*pow(S,2) - 4852.118868792147*pow(S,3)) - 101.56181324122346*pow(S,3) + eta*(-1391.8716319015452 + 593.5564135591572*S - 1953.8104273227282*pow(S,2) + 1245.337617687378*pow(S,3)) + pow(eta,3)*(-8055.853025143602 + 8537.864829573089*S - 41786.08351683194*pow(S,2) + 6212.061120000858*pow(S,3))) + dchi*(-2.403108588866492 - 28.405718846884586*S + 2.7725994008606802*pow(S,2) + pow(eta,2)*(571.7350765376542 - 1692.7798923154326*S - 867.2161744320235*pow(S,2) - 16207.24226065234*pow(S,3)) - 100.72115397091184*pow(S,3) + eta*(-57.50150093717991 + 395.00777484466863*S + 112.53873787934577*pow(S,2) + 2355.399972660514*pow(S,3)) + pow(eta,3)*(-1218.0533861654671 + 2228.1041895987705*S + 1462.6397159824712*pow(S,2) + 34281.82148605547*pow(S,3)))) + (-13.592968470307802 + 67.94338167477596*eta + 3279.822738348386*pow(eta,2) - 52472.441259695006*pow(eta,3) + 307158.9607823966*pow(eta,4) - 793578.4943822795*pow(eta,5) + 763789.2694207432*pow(eta,6))*pow(S,4) + (-73.36051643902637 + 3499.4968096323755*eta - 67457.29215985344*pow(eta,2) + 686045.1063391512*pow(eta,3) - 3.79284206671871e6*pow(eta,4) + 1.066927854051988e7*pow(eta,5) - 1.1909656825474834e7*pow(eta,6))*pow(S,5) + (24.853261444650556 - 832.7124569178613*eta + 18367.763090257435*pow(eta,2) - 228296.22359378161*pow(eta,3) + 1.5017064751550811e6*pow(eta,4) - 4.843098555705261e6*pow(eta,5) + 6.00809087044844e6*pow(eta,6))*pow(S,6) + (132.48895173301014 - 7029.083687233774*eta + 152112.50733353404*pow(eta,2) - 1.6707796428542323e6*pow(eta,3) + 9.67119180377533e6*pow(eta,4) - 2.7994770160684623e7*pow(eta,5) + 3.188255927908381e7*pow(eta,6))*pow(S,7) + (-17.56881120464217 + 793.8452809749411*eta - 20153.338664815346*pow(eta,2) + 261770.37169406656*pow(eta,3) - 1.7321606593691786e6*pow(eta,4) + 5.557889619339143e6*pow(eta,5) - 6.853957419570083e6*pow(eta,6))*pow(S,8) + (-76.08896143228581 + 4362.363880017468*eta - 101796.76912261258*pow(eta,2) + 1.1725041662277707e6*pow(eta,3) - 6.983317762952185e6*pow(eta,4) + 2.058215321168346e7*pow(eta,5) - 2.3730758523599517e7*pow(eta,6))*pow(S,9);
  return fit;
}

static double IMRPhenomTv2_xCutMergerFit(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.16923258415101877 + 0.5428156525731634*eta - 41.21229259326913*pow(eta,2) + 1062.6909487202674*pow(eta,3) - 15435.106721734432*pow(eta,4) + 141711.48905814943*pow(eta,5) - 855887.2271010121*pow(eta,6) + 3.404237463189647e6*pow(eta,7) - 8.602688932776589e6*pow(eta,8) + S*(0.07490013299620567 - 1.167896226250503*eta + 35.87089510248999*pow(eta,2) - 703.6236192327042*pow(eta,3) + 7925.408615982407*pow(eta,4) - 52568.401341338795*pow(eta,5) + 203644.32593676625*pow(eta,6) - 426797.8063540432*pow(eta,7) + 374119.63824904314*pow(eta,8)) + 1.2537556805116832e7*pow(eta,9) - 8.031673018538837e6*pow(eta,10) + (0.04344127986652498 - 1.2559167954097006*eta + 37.64581035019567*pow(eta,2) - 656.111607426068*pow(eta,3) + 6562.723271777221*pow(eta,4) - 38960.00770227554*pow(eta,5) + 136089.3244956284*pow(eta,6) - 258689.65441051315*pow(eta,7) + 206504.30497538584*pow(eta,8))*pow(S,2) + (-0.014216424468980112 + 5.538012237630402*eta - 260.31825094687605*pow(eta,2) + 5375.453808066043*pow(eta,3) - 60414.55368450496*pow(eta,4) + 395968.6951628789*pow(eta,5) - 1.5127851411307636e6*pow(eta,6) + 3.124642953580092e6*pow(eta,7) - 2.6978362490154305e6*pow(eta,8))*pow(S,3) + dchi*pow(eta,2)*(delta*(-0.6037100578430442 - 0.7111739716300636*S - 0.4642065238530262*pow(S,2) + eta*(5.886296125568762 + 9.667850851775663*S + 7.269791424139767*pow(S,2) - 0.8050816427836989*pow(S,3)) + 0.09578325670870715*pow(S,3) + pow(eta,2)*(-26.07386188821871 - 47.27230069474824*S - 37.49984908808399*pow(S,2) + 1.1403761169879665*pow(S,3)) + pow(eta,3)*(40.83637242175853 + 77.8765158849462*S + 65.55892088352702*pow(S,2) + 6.062911247861945*pow(S,3))) + dchi*(0.03253302406326991 - 0.07591722676149035*S - 0.03985588791111127*pow(S,2) + pow(eta,3)*(-5.4139036459545515 + 7.355037806391115*S + 3.253248543884677*pow(S,2) - 21.427085333524833*pow(S,3)) + eta*(-0.567933804454607 + 1.058296899223617*S + 0.543967385909318*pow(S,2) - 2.5846501236971897*pow(S,3)) + 0.16487815403244974*pow(S,3) + pow(eta,2)*(3.1100521615626695 - 4.851104797712621*S - 2.327728559759377*pow(S,2) + 13.063980029892003*pow(S,3)))) + (0.05194172654114222 - 5.5443455715866055*eta + 185.72508293652075*pow(eta,2) - 2939.7671688506603*pow(eta,3) + 25485.722920063294*pow(eta,4) - 127515.5625117312*pow(eta,5) + 363832.090656289*pow(eta,6) - 541005.8443500961*pow(eta,7) + 316345.5581569845*pow(eta,8))*pow(S,4) + (0.20756773304932785 - 26.97545694933132*eta + 1148.1068598364625*pow(eta,2) - 23122.52205063188*pow(eta,3) + 257736.01065439387*pow(eta,4) - 1.6836185939834933e6*pow(eta,5) + 6.417346436999891e6*pow(eta,6) - 1.3217800028152928e7*pow(eta,7) + 1.1368011953080256e7*pow(eta,8))*pow(S,5) + (-0.046245197604544666 + 10.033795673975055*eta - 296.6090739346418*pow(eta,2) + 3186.236680415402*pow(eta,3) - 8315.574542756221*pow(eta,4) - 95742.2948788284*pow(eta,5) + 844825.907046725*pow(eta,6) - 2.5712343686240544e6*pow(eta,7) + 2.8150326763136173e6*pow(eta,8))*pow(S,6) + (-0.36830087624254254 + 44.74534707361014*eta - 1921.773840834454*pow(eta,2) + 39639.80973461575*pow(eta,3) - 452083.1373642425*pow(eta,4) + 3.0095281392254047e6*pow(eta,5) - 1.1643922778882664e7*pow(eta,6) + 2.4263326046229865e7*pow(eta,7) - 2.1055575743207563e7*pow(eta,8))*pow(S,7) + (-0.02138565089026436 - 5.388414839189936*eta + 19.69491161679162*pow(eta,2) + 4413.645130111549*pow(eta,3) - 96206.0622576686*pow(eta,4) + 885345.1797195538*pow(eta,5) - 4.1869639060994857e6*pow(eta,6) + 1.0015560597169053e7*pow(eta,7) - 9.614900741188917e6*pow(eta,8))*pow(S,8) + (0.2749730183262901 - 28.869080606700617*eta + 1203.472152835721*pow(eta,2) - 24894.498659367124*pow(eta,3) + 286688.6262576487*pow(eta,4) - 1.9276690800899393e6*pow(eta,5) + 7.52362499989239e6*pow(eta,6) - 1.5792175344942216e7*pow(eta,7) + 1.378674632294569e7*pow(eta,8))*pow(S,9) + (0.09793075664871681 - 3.9083629422459563*eta + 236.0660793471047*pow(eta,2) - 7204.938835464331*pow(eta,3) + 106039.4430843184*pow(eta,4) - 836279.4832097485*pow(eta,5) + 3.643562684444438e6*pow(eta,6) - 8.282836538711506e6*pow(eta,7) + 7.678739891156858e6*pow(eta,8))*pow(S,10);
  return fit;
}

static double IMRPhenomTv2_xPeak(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.1944319279480693 + 13.17062529962385*eta - 708.2716938783424*pow(eta,2) + 19648.94713504504*pow(eta,3) - 331342.33488191525*pow(eta,4) + 3.678214477107212e6*pow(eta,5) - 2.787214418893622e7*pow(eta,6) + S*(0.05969109810511849 - 0.10383505452516291*eta + 5.696758596584492*pow(eta,2) - 112.5199308483719*pow(eta,3) + 908.6219295166767*pow(eta,4) - 3295.154156293412*pow(eta,5) + 4428.777541120565*pow(eta,6)) + 1.4552994298773828e8*pow(eta,7) - 5.161599631856793e8*pow(eta,8) + 1.189120312217986e9*pow(eta,9) - 1.6061573608062506e9*pow(eta,10) + 9.657643642463362e8*pow(eta,11) + (0.015479011364232798 - 0.35430798435094635*eta + 14.409516245176084*pow(eta,2) - 189.94429317313268*pow(eta,3) + 1193.4302512532483*pow(eta,4) - 3600.6832440037274*pow(eta,5) + 4133.892331243837*pow(eta,6))*pow(S,2) + (0.08512635329566585 - 7.435646433125764*eta + 180.65362852420188*pow(eta,2) - 1969.196690798935*pow(eta,3) + 10802.342889368187*pow(eta,4) - 29078.956574081298*pow(eta,5) + 30540.044165459065*pow(eta,6))*pow(S,3) + dchi*pow(eta,2)*(dchi*(-0.10193713365502874 + 0.4724992991494502*S + 0.07198948036880885*pow(S,2) + pow(eta,2)*(-5.00951590047026 + 20.334600373758274*S - 13.4328790268347*pow(S,2) - 0.7102638391904565*pow(S,3)) + eta*(1.1908931294089702 - 5.517527459312549*S + 0.9898645370469039*pow(S,2) + 0.21268949890097325*pow(S,3)) - 0.06140374832102454*pow(S,3) + pow(eta,3)*(7.214282346050293 - 22.92930488869344*S + 34.427661062548275*pow(S,2) + 5.8800784080222925*pow(S,3))) + delta*(0.41684013005585324 - 0.27933476958362813*S - 3.9293953166906186*pow(S,2) + pow(eta,3)*(-68.84686699360768 + 181.05563694573055*S + 344.59993568951586*pow(S,2) - 358.9823916103993*pow(S,3)) + eta*(-7.748781312361421 + 9.542357473901301*S + 55.033892708389445*pow(S,2) - 2.5900340891950173*pow(S,3)) - 1.1137829066912037*pow(S,3) + pow(eta,2)*(41.946958586206534 - 78.31066235773962*S - 245.37521538089692*pow(S,2) + 116.45510955560509*pow(S,3)))) + (-0.014283983136664827 + 6.882371158899161*eta - 191.3001051033377*pow(eta,2) + 2158.5447771778036*pow(eta,3) - 12196.86574663302*pow(eta,4) + 34020.726039148285*pow(eta,5) - 37131.04298462693*pow(eta,6))*pow(S,4) + (-0.29291331799012554 + 41.526224219128714*eta - 1132.76757429942*pow(eta,2) + 13247.184835659073*pow(eta,3) - 76916.79836601682*pow(eta,4) + 218441.61521817397*pow(eta,5) - 242261.9056508307*pow(eta,6))*pow(S,5) + (0.08027093468040061 - 21.876700052503672*eta + 648.6041126944039*pow(eta,2) - 7727.196573810559*pow(eta,3) + 45215.139039102774*pow(eta,4) - 129286.95304680182*pow(eta,5) + 144353.49407160637*pow(eta,6))*pow(S,6) + (0.44188753587714275 - 77.1497066904743*eta + 2243.7959630410464*pow(eta,2) - 27076.534811299574*pow(eta,3) + 160045.36471304108*pow(eta,4) - 459913.5881652755*pow(eta,5) + 514640.9050907439*pow(eta,6))*pow(S,7) + (-0.011288994928229656 + 17.284281896508748*eta - 549.1555459857134*pow(eta,2) + 6749.313843660931*pow(eta,3) - 40243.49713584469*pow(eta,4) + 116655.27837423397*pow(eta,5) - 131783.53449603732*pow(eta,6))*pow(S,8) + (-0.1952040346801642 + 47.62085798883019*eta - 1458.3634137005092*pow(eta,2) + 17975.295359441916*pow(eta,3) - 107391.99197353245*pow(eta,4) + 310464.1301967964*pow(eta,5) - 348646.08689661184*pow(eta,6))*pow(S,9);
  return fit;
}

/* Amplitude */
static UNUSED double IMRPhenomT_Inspiral_Amp_CP0_22v2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.9388704787107108 + 0.06854692552917768*eta - 0.19279923515327727*pow(eta,2) - 1.4704021294470877*pow(eta,3) + S*(-0.015661991771272074 + 0.029319969565102303*eta + 0.01888145438196064*pow(eta,2) - 0.34771896295659577*pow(eta,3) + 0.536834883891653*pow(eta,4)) + 32.71558859975698*pow(eta,4) - 187.26938815917208*pow(eta,5) + 449.0316496176266*pow(eta,6) - 386.79001896191033*pow(eta,7) + (0.00282219148799045 + 0.04380164968436185*eta - 0.780573672759867*pow(eta,2) + 3.5781417095963475*pow(eta,3) - 4.71246441568306*pow(eta,4))*pow(S,2) + (0.0026908899143560545 - 0.12316306062318667*eta + 1.486620309872672*pow(eta,2) - 7.161089006528935*pow(eta,3) + 12.099041492904634*pow(eta,4))*pow(S,3) + dchi*eta*(dchi*(-0.017424640426787073 + 0.052557722713868*S + 0.03190466207165621*pow(S,2) + pow(eta,2)*(-1.2009774834321654 + 3.240125078538939*S + 3.391873135237058*pow(S,2) - 5.999066115332298*pow(S,3)) - 0.10875044653988737*pow(S,3) + eta*(0.25595747590090406 - 0.7226436986839346*S - 0.5754718249184393*pow(S,2) + 1.4114804545891058*pow(S,3)) + pow(eta,3)*(1.8247914095449063 - 4.7464646336768945*S - 6.47358789506029*pow(S,2) + 8.411947039314427*pow(S,3))) + delta*(0.02548386762682783 - 0.06549214009750783*S + 0.02893993305923662*pow(S,2) + pow(eta,2)*(1.6782785874750432 - 7.131553557372865*S + 0.10751413777449505*pow(S,2) - 9.475509524063979*pow(S,3)) - 0.07368676918266918*pow(S,3) + eta*(-0.299668905058541 + 1.1848578327185515*S - 0.19701480183981157*pow(S,2) + 1.4280028927502892*pow(S,3)) + pow(eta,3)*(-2.718337801708289 + 13.371150603237046*S + 0.829359421981324*pow(S,2) + 20.099748099473278*pow(S,3)))) + (0.0026436365186598416 - 0.30027396179957483*eta + 4.372175540998765*pow(eta,2) - 20.05918755000392*pow(eta,3) + 28.65991373428418*pow(eta,4))*pow(S,4) + (-0.002037806390103573 + 0.12806884914069808*eta - 1.6601877865849801*pow(eta,2) + 8.175260244993128*pow(eta,3) - 13.8713323089339*pow(eta,4))*pow(S,5) + (-0.0028780154977920617 + 0.2741131310287963*eta - 3.971349296220499*pow(eta,2) + 18.379479796309077*pow(eta,3) - 26.65141136363424*pow(eta,4))*pow(S,6);
  return fit;
}

static double IMRPhenomT_Inspiral_Amp_CP1_22v2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.9161859404864149 + 0.06765086306173795*eta + 2.8380306123279606*pow(eta,2) - 38.9898439127645*pow(eta,3) + S*(-0.05784172175311836 + 0.5696219429871398*eta - 3.1898962929300243*pow(eta,2) + 8.384123646828431*pow(eta,3) - 8.50771628965519*pow(eta,4)) + 271.670079289724*pow(eta,4) - 1079.2378814048373*pow(eta,5) + 2271.8087520129898*pow(eta,6) - 1943.19100350951*pow(eta,7) + (0.011784927861272228 - 0.05031009537332927*eta - 0.18039307762558932*pow(eta,2) + 0.8832760639364383*pow(eta,3) + 0.7255878855481763*pow(eta,4))*pow(S,2) + (-0.0017230203669892634 - 0.006426212692788328*eta - 0.20931830707460106*pow(eta,2) + 2.237108506448531*pow(eta,3) - 4.640848915692429*pow(eta,4))*pow(S,3) + dchi*eta*(delta*(0.009567665220385957 - 0.009907403599127217*S + 0.2521474875900892*pow(S,2) + eta*(0.162780342928921 + 0.26987726194213296*S - 4.515433663946001*pow(S,2) - 0.6438154661322678*pow(S,3)) + 0.06363167050143495*pow(S,3) + pow(eta,2)*(-1.2731134125324568 - 2.7164773076803153*S + 26.1215465049965*pow(S,2) + 1.2001529964063313*pow(S,3)) + pow(eta,3)*(3.235265574312793 + 6.492036828483831*S - 48.80028758099775*pow(S,2) + 1.3269997587885691*pow(S,3))) + dchi*(-0.013156575304970865 - 0.02085722350213995*S - 0.05988180541884901*pow(S,2) + pow(eta,2)*(-0.9861953531894062 - 0.9894439644185743*S - 1.8192600829631242*pow(S,2) - 15.736241934557576*pow(S,3)) - 0.1672099111362533*pow(S,3) + eta*(0.20630953933457985 + 0.2443048175226647*S + 0.6389956166848783*pow(S,2) + 2.8686327824888225*pow(S,3)) + pow(eta,3)*(1.4881155561586383 + 1.4081040672556537*S + 0.7510265820571367*pow(S,2) + 27.91442062970824*pow(S,3)))) + (0.005551946059666119 - 0.4100922702381339*eta + 5.195630224433327*pow(eta,2) - 20.251364460099037*pow(eta,3) + 22.34162003178973*pow(eta,4))*pow(S,4) + (-0.0005935218434596234 + 0.08058759431406524*eta - 0.6628575656742137*pow(eta,2) + 1.8814227035324051*pow(eta,3) - 2.0269764472719096*pow(eta,4))*pow(S,5) + (-0.004747787308821141 + 0.35984995076079057*eta - 4.665645031878674*pow(eta,2) + 18.724955124903392*pow(eta,3) - 21.794929839877113*pow(eta,4))*pow(S,6);
  return fit;
}

static double IMRPhenomT_Inspiral_Amp_CP2_22v2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.9257543817890057 - 0.2120756890844721*eta + 6.999855309725984*pow(eta,2) - 125.02935189053342*pow(eta,3) + 1401.3005711090264*pow(eta,4) + S*(-0.10741430163038318 - 0.255010790535943*eta + 22.355961064509568*pow(eta,2) - 236.77839003540743*pow(eta,3) + 954.0720322705249*pow(eta,4) - 1341.237870377199*pow(eta,5)) - 9484.436194072234*pow(eta,5) + 37707.40608114242*pow(eta,6) - 81031.59310173409*pow(eta,7) + 72560.20042027316*pow(eta,8) + (0.025579414986344855 - 2.311529838536404*eta + 60.2043744091253*pow(eta,2) - 547.8249690821814*pow(eta,3) + 2048.6715860320987*pow(eta,4) - 2709.3724867801157*pow(eta,5))*pow(S,2) + (-0.042593553794926846 + 6.172845719398019*eta - 166.91789741178948*pow(eta,2) + 1558.2989724113568*pow(eta,3) - 6019.481545223119*pow(eta,4) + 8293.326831170058*pow(eta,5))*pow(S,3) + dchi*eta*(dchi*(-0.16141052768607844 - 0.3451870349816429*S + 0.3008205713021054*pow(S,2) + eta*(2.270218262348641 + 4.622959553009155*S - 4.511907715771173*pow(S,2) - 3.911110150268221*pow(S,3)) + 0.43601017428433864*pow(S,3) + pow(eta,3)*(15.547139126671793 + 30.596403327914143*S - 38.66491275141587*pow(S,2) + 4.189277365039538*pow(S,3)) + pow(eta,2)*(-10.376429426057044 - 20.60782773755467*S + 22.801156849128574*pow(S,2) + 7.778322481687539*pow(S,3))) + delta*(0.13630841125675525 - 0.024830665591688485*S + 0.6844481347929883*pow(S,2) + eta*(-1.2073718296393858 - 1.101952497451903*S - 14.252903068971444*pow(S,2) - 4.591216566378461*pow(S,3)) + pow(eta,3)*(-4.681813360418259 - 22.494467133930232*S - 178.3922278439572*pow(S,2) - 1.9353486934064046*pow(S,3)) + 0.5027314518451225*pow(S,3) + pow(eta,2)*(4.742089190167106 + 9.909425432562186*S + 89.92424251046965*pow(S,2) + 10.494947666328114*pow(S,3)))) + (-0.09201597171887124 + 10.713748011733035*eta - 279.12376554469876*pow(eta,2) + 2533.336802703641*pow(eta,3) - 9477.046874912865*pow(eta,4) + 12585.427985798786*pow(eta,5))*pow(S,4) + (0.04442840180561043 - 6.583774359447948*eta + 182.77248214512196*pow(eta,2) - 1727.0994359736094*pow(eta,3) + 6716.144637787633*pow(eta,4) - 9288.911394443272*pow(eta,5))*pow(S,5) + (0.07353510141313704 - 9.755029167264723*eta + 261.43514441142*pow(eta,2) - 2395.32044250727*pow(eta,3) + 9003.870858196071*pow(eta,4) - 11997.132883313441*pow(eta,5))*pow(S,6);
  return fit;
}

static double IMRPhenomT_Inspiral_Amp_CP3_22v2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.9503299852776116 + 0.07644455505379345*eta - 14.898616615901991*pow(eta,2) + 0.2557022284634896*dchi*delta*pow(eta,2) + 0.01067683340642892*pow(dchi,2)*pow(eta,2) - 0.09570326405263938*dchi*S*pow(delta,0.5)*pow(eta,2) + 297.17568359427906*pow(eta,3) - 2931.602506376721*pow(eta,4) + S*(-0.14073786251238146 - 0.7656426723853753*eta + 26.215334265938303*pow(eta,2) - 234.7422386411623*pow(eta,3) + 872.767711528003*pow(eta,4) - 1166.605960132269*pow(eta,5)) + 16777.872088895838*pow(eta,5) - 56705.457306601435*pow(eta,6) + 105343.36520350698*pow(eta,7) - 83204.7259393072*pow(eta,8) + (0.007790384455280628 - 2.748359252336234*eta + 56.87734189550518*pow(eta,2) - 447.9481073454658*pow(eta,3) + 1532.409538513434*pow(eta,4) - 1903.7713098347701*pow(eta,5))*pow(S,2) + (-0.035924887077230565 + 7.343834096837705*eta - 170.16761295963943*pow(eta,2) + 1453.9135533968292*pow(eta,3) - 5333.5065459811585*pow(eta,4) + 7122.431717714108*pow(eta,5))*pow(S,3) + dchi*eta*(delta*(0.10265425106502109 + 0.14421812112901883*S + 0.14571862391499837*pow(S,2) + pow(eta,2)*(3.4942494441408996 + 1.5378532348690628*S + 28.49503246397191*pow(S,2) - 23.22252517905146*pow(S,3)) - 0.37354300650234584*pow(S,3) + eta*(-1.0207859080155546 - 1.434869217942611*S - 4.11778884126028*pow(S,2) + 5.36740798501696*pow(S,3)) + pow(eta,3)*(-4.5581243612171605 + 9.394830806148448*S - 59.72081125057423*pow(S,2) + 28.538908109489245*pow(S,3))) + dchi*(-0.10091492488337787 - 0.13645920969415312*S + 0.15040181303453742*pow(S,2) + pow(eta,2)*(-7.640523812339684 - 5.3003792497238305*S + 15.379581307810176*pow(S,2) - 32.69073740912708*pow(S,3)) - 0.1889313473356824*pow(S,3) + eta*(1.5422645202159182 + 1.5122896797944183*S - 2.6539500340383326*pow(S,2) + 4.8501154826730986*pow(S,3)) + pow(eta,3)*(12.350560775381387 + 5.804082543283848*S - 29.148762994389205*pow(S,2) + 66.02116219510776*pow(S,3)))) + (-0.16325048790805738 + 15.598304107708145*eta - 321.0240783390499*pow(eta,2) + 2588.0097510883547*pow(eta,3) - 9080.657283044193*pow(eta,4) + 11628.72982763535*pow(eta,5))*pow(S,4) + (0.01983455554007725 - 6.020576177158644*eta + 149.32969309898087*pow(eta,2) - 1324.0685116702239*pow(eta,3) + 4981.41987784723*pow(eta,4) - 6776.512122763848*pow(eta,5))*pow(S,5) + (0.11378315032836805 - 13.142684567602336*eta + 285.5479322104333*pow(eta,2) - 2365.4600592367424*pow(eta,3) + 8444.648047605186*pow(eta,4) - 10954.4071463388*pow(eta,5))*pow(S,6);
  return fit;
}

static double IMRPhenomT_Inspiral_Amp_CP4_22v2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.9351503456526435 + 0.795671209351516*eta - 52.672254372372834*pow(eta,2) + 0.10453999120165845*dchi*delta*pow(eta,2) + 0.02740983602182549*pow(dchi,2)*pow(eta,2) - 0.13388184932956387*dchi*S*pow(delta,0.5)*pow(eta,2) + 1117.3959349117868*pow(eta,3) - 12724.586678807054*pow(eta,4) + S*(-0.11612597618881125 - 2.0825634237560786*eta + 46.352299680308526*pow(eta,2) - 390.41286700517605*pow(eta,3) + 1436.8072031327486*pow(eta,4) - 1928.1054562752618*pow(eta,5)) + 84868.15000801024*pow(eta,5) - 332326.451843262*pow(eta,6) + 708164.2397794824*pow(eta,7) - 634098.6853501304*pow(eta,8) + (0.012537324272378842 - 3.400171903656091*eta + 65.12769198462888*pow(eta,2) - 491.58270224116836*pow(eta,3) + 1601.6609033653724*pow(eta,4) - 1850.2174568154246*pow(eta,5))*pow(S,2) + (-0.07450034847475989 + 12.145514269620307*eta - 274.3123328413824*pow(eta,2) + 2305.640347510012*pow(eta,3) - 8349.145755204354*pow(eta,4) + 11032.644361654267*pow(eta,5))*pow(S,3) + dchi*eta*(dchi*(-0.26539592283583024 - 0.6269378559123057*S + 0.07912014324937688*pow(S,2) + pow(eta,2)*(-17.987060721500622 - 43.275772479784784*S + 8.716097646277845*pow(S,2) - 16.501885255865382*pow(S,3)) - 0.0339489814328821*pow(S,3) + eta*(3.7955133183220515 + 9.04663233088346*S - 1.3990725457640902*pow(S,2) + 2.083740724861905*pow(S,3)) + pow(eta,3)*(28.237736192525777 + 68.76903839096019*S - 18.33070992764502*pow(S,2) + 35.55831938051483*pow(S,3))) + delta*(0.30157134124493656 + 0.7274930848839878*S + 0.4016029939841985*pow(S,2) + pow(eta,2)*(20.38153339748721 + 48.218929710224636*S + 37.00413052401728*pow(S,2) - 39.755752819406766*pow(S,3)) - 0.5045510584233985*pow(S,3) + eta*(-4.250789184021173 - 10.318356698351904*S - 6.973366191753083*pow(S,2) + 7.525849131271099*pow(S,3)) + pow(eta,3)*(-33.358173660076595 - 73.67792783126175*S - 63.13869024669875*pow(S,2) + 73.02769053643385*pow(S,3)))) + (-0.23505910108061245 + 19.250056375017614*eta - 399.1591113127891*pow(eta,2) + 3261.275290846868*pow(eta,3) - 11504.428795368141*pow(eta,4) + 14678.839141223265*pow(eta,5))*pow(S,4) + (0.05514712174615777 - 13.124516274088748*eta + 295.8276486259437*pow(eta,2) - 2459.791171069588*pow(eta,3) + 8816.60480948163*pow(eta,4) - 11539.45309652603*pow(eta,5))*pow(S,5) + (0.1860444954769472 - 20.121607351272257*eta + 435.8669842538572*pow(eta,2) - 3635.873774153769*pow(eta,3) + 13065.617681531805*pow(eta,4) - 17011.818005912333*pow(eta,5))*pow(S,6);
  return fit;
}

static double IMRPhenomT_Inspiral_Amp_CP5_22v2(double eta, double S, double dchi, double delta)
{
  double fit;

  fit = 0.8288706666849882 + 2.290899164470238*eta + S*(-0.1054959257656669 - 0.26159586559490167*eta + 0.979610751791986*pow(eta,2)) - 123.44423142725671*pow(eta,2) + 0.011003744754610717*dchi*delta*pow(eta,2) + 0.03558004339259044*pow(dchi,2)*pow(eta,2) - 0.20435942124412207*dchi*S*pow(delta,0.5)*pow(eta,2) + 2640.4732936413184*pow(eta,3) - 30393.592512701147*pow(eta,4) + 202973.5400533202*pow(eta,5) - 789975.5071673167*pow(eta,6) + 1.6664704936042372e6*pow(eta,7) - 1.474918587548389e6*pow(eta,8) + (0.03811734423029461 - 0.9707085043016191*eta + 3.3891575888413317*pow(eta,2))*pow(S,2) + (-0.0414222956230596 + 0.24286879945410292*eta - 0.2834510693977443*pow(eta,2))*pow(S,3) + (-0.27000412098436954 + 3.087973323237131*eta - 8.551613808397894*pow(eta,2))*pow(S,4) + (-0.008575820034480796 + 0.00616015204692037*eta + 0.12157756220006775*pow(eta,2))*pow(S,5) + (0.1696231844454044 - 2.1476618281328146*eta + 6.189359233720802*pow(eta,2))*pow(S,6);
  return fit;
}
